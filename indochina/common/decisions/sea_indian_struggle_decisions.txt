# No lists or indexes, only chaos. Keep scrolling down and thou shalt find them.

#############################################
# Hostility Ending					    	#
# by Joe Parkin								#
#############################################

start_struggle_debug = {
	major = yes
	title = "START STRUGGLE"
	desc = "START STRUGGLE"
	selection_tooltip = "START STRUGGLE"
	is_shown = {
		always = yes
	}
	effect = {
		start_struggle = {
			struggle_type = indian_struggle
			start_phase = struggle_india_dominance
		}
	}
	ai_check_interval = 0
}

become_chakravarti_decision = {
	major = yes
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					OR = {
						religion = religion:hinduism_religion
						religion = religion:buddhism_religion
						religion = religion:jainism_religion
						religion = religion:indian_religion
					}
				}
				desc = become_chakravarti_decision_title_dharmic
			}
			triggered_desc = {
				trigger = {
					religion = religion:islam_religion
				}
				desc = become_chakravarti_decision_title_muslim
			}
			triggered_desc = {
				trigger = {
					OR = {
						culture = { has_cultural_pillar = language_greek }
						culture = { any_parent_culture_or_above = { this = culture:greek } }
						religion = religion:hellenism_religion
					}
				}
				desc = become_chakravarti_decision_title_hellenic
			}
			desc = become_chakravarti_decision_title_else
		}
	}
	picture = "gfx/interface/illustrations/decisions/fp2_decision_struggle_hostility.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/fp2_decision_hostility.dds"
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					OR = {
						religion = religion:hinduism_religion
						religion = religion:buddhism_religion
						religion = religion:jainism_religion
						religion = religion:indian_religion
					}
				}
				desc = become_chakravarti_decision_desc_dharmic
			}
			triggered_desc = {
				trigger = {
					religion = religion:islam_religion
				}
				desc = become_chakravarti_decision_desc_muslim
			}
			triggered_desc = {
				trigger = {
					OR = {
						culture = { has_cultural_pillar = language_greek }
						culture = { any_parent_culture_or_above = { this = culture:greek } }
						religion = religion:hellenism_religion
					}
				}
				desc = become_chakravarti_decision_desc_hellenic
			}
			desc = become_chakravarti_decision_desc_else
		}
	}
	selection_tooltip = become_chakravarti_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes
	sort_order = 80

	is_shown = {
		has_fp2_dlc_trigger = yes
	}

	is_valid = {
		is_independent_ruler = yes
		highest_held_title_tier >= tier_kingdom
		completely_controls = title:e_rajastan
		completely_controls = title:e_deccan
		completely_controls = title:e_bengal
		piety_level >= 5

		custom_tooltip = {
			text = struggle_india_ending_dominance_decision_correct_phase_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = indian_struggle
				is_struggle_phase = struggle_india_dominance
			}
		}

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = indian_struggle
			}
		}

		trigger_if = {
			limit = { religion = religion:hinduism_religion }
			custom_tooltip = {
				text = dominant_religion_trigger_tt_hindu
				struggle_india_hindu_share >= 0.6
			}
		}
		trigger_else_if = {
			limit = { religion = religion:buddhism_religion }
			custom_tooltip = {
				text = dominant_religion_trigger_tt_buddhist
				struggle_india_buddhist_share >= 0.6
			}
		}
		trigger_else_if = {
			limit = { religion = religion:jainism_religion }
			custom_tooltip = {
				text = dominant_religion_trigger_tt_jainist
				struggle_india_jainist_share >= 0.6
			}
		}
		trigger_else_if = {
			limit = { religion = religion:islam_religion }
			custom_tooltip = {
				text = dominant_religion_trigger_tt_muslim
				struggle_india_muslim_share >= 0.6
			}
		}
		trigger_else_if = {
			limit = { religion = religion:indian_religion }
			custom_tooltip = {
				text = dominant_religion_trigger_tt_indian_pagan
				struggle_india_indian_pagan_share >= 0.6
			}
		}
		trigger_else = {
			custom_tooltip = {
				text = dominant_religion_trigger_tt_foreign
				struggle_india_foreign_share >= 0.6
			}
		}
	}

	is_valid_showing_failures_only = {
		is_adult = yes
		is_available = yes
		is_independent_ruler = yes
	}

	cost = {
		piety = {
			value = massive_piety_value
		}
		gold = {
			value = massive_gold_value
		}
	}

	effect = {
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:become_chakravarti_decision
		}
		##### Major Effects #####
		show_as_tooltip = {
			dynasty = { add_dynasty_prestige = 10000 }
			fp2_struggle_hostility_ender_effect = yes
			custom_tooltip = become_chakravarti_decision_indian_empires_unite_effect
			if = {
				limit = { NOT = { has_title = title:e_indo_greek_kingdom } }
				custom_tooltip = become_chakravarti_decision_new_primary_title_effect
			}
			show_as_tooltip = {
				add_trait = chakravarti
				add_prestige = massive_prestige_value
				add_prestige_level = 2
				faith = {
					add_doctrine = divine_destiny_doctrine
					change_fervor = {
						value = major_fervor_gain
						desc = fervor_gain_chakravarti
					}
				}
			}
			save_scope_as = chakravarti
			trigger_event = south_asia.0001 #I became the Chakravarti
			add_to_temporary_list = received_notification
			every_vassal_or_below = {
				if = {
					limit = {
						OR = {
							faith.religion = faith:vaishnavism.religion
							faith.religion = faith:theravada.religion
							faith.religion = faith:digambara.religion		
						}
					}
					trigger_event = south_asia.0002 #My ruler became the Chakravarti
				}
				else = {
					trigger_event = south_asia.0003 #My ruler became the Chakravarti - convert?
				}
				add_to_temporary_list = received_notification
			}
			struggle:indian_struggle = {
				every_involved_character = {
					trigger_event = south_asia.0004
				}
			}
		}
	}

	widget = {
		gui = "decision_view_india_struggle_pie_chart"
	}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

struggle_india_ending_religious_peace_decision = {
	major = yes
	title = struggle_india_ending_religious_peace_decision
	picture = "gfx/interface/illustrations/decisions/fp2_decision_struggle_hostility.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/fp2_decision_hostility.dds"
	desc = struggle_india_ending_religious_peace_decision_desc
	selection_tooltip = struggle_india_ending_religious_peace_decision_tooltip
	confirm_click_sound = "event:/DLC/FP2/SFX/UI/fp2_struggle_ending_decision_confirm"
	is_invisible = yes
	sort_order = 80

	is_shown = {
		has_fp2_dlc_trigger = yes
	}

	is_valid = {
		is_independent_ruler = yes

		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = indian_struggle
			}
		}

		custom_tooltip = {
			text = struggle_india_ending_realignment_decision_correct_phase_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = indian_struggle
				is_struggle_phase = struggle_india_realignment
			}
		}
	}

	effect = {
		##### Major Effects #####
		show_as_tooltip = {
			dynasty = { add_dynasty_prestige = 10000 }
			fp2_struggle_hostility_ender_effect = yes
		}
	}

	widget = {
		gui = "decision_view_india_struggle_pie_chart"
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

restore_indo_greek_kingdom_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_personal_religious.dds"
	major = yes
	desc = restore_indo_greek_kingdom_decision_desc

	ai_check_interval = 120

	is_shown = {
		capital_county.title_province = {
			geographical_region = custom_indo_greek_kingdom
		}
		# Need to have a cultural or religious tie to the Hellenes:
		OR = {
			has_religion = religion:hellenism_religion
			culture = culture:greek
			culture = {
				any_parent_culture = { this = culture:greek }
			}
		}
	}

	is_valid = {
		is_independent_ruler = yes
		prestige_level >= 4
		# # Must be of the right religion: Buddhist, Zoroastrian, Hindu or Greco-Roman
		OR = {
			has_religion = religion:hellenism_religion
			has_religion = religion:zoroastrianism_religion
			has_religion = religion:buddhism_religion
			has_religion = religion:hinduism_religion
		}
		# # Must have Greek roots, and either Byzantine or Indo-aryan heritage
		OR = {
			culture = culture:greek
			culture = {
				any_parent_culture = { this = culture:greek }
				OR = {
					has_cultural_pillar = heritage_byzantine
					has_cultural_pillar = heritage_indo_aryan
				}
			}
		}
		OR = {
			# Greco-bactria was kinda the predecessor to the Indo-Greek Kingdom
			highest_held_title_tier <= tier_kingdom
			has_title = title:e_bactria
		}
		completely_controls_region = custom_indo_greek_kingdom_heartland
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult = yes
	}

	effect = {
		custom_tooltip = {
			text = indo_greek_de_jure_tt
		}
		hidden_effect = {
			indo_greek_de_jure_effect = yes
		}
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
		}
		title:e_indo_greek_kingdom = {
			change_title_holder = {
				holder = ROOT
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change
		show_as_tooltip = {
			reform_indo_hellenism_effect = yes
			custom_tooltip = reform_indo_hellenism.desc
			random_list = {
				100 = {
					show_chance = no
					desc = reform_indo_hellenism.buddhist
					greco_buddhism_effect = yes
				}
				100 = {
					show_chance = no
					desc = reform_indo_hellenism.hindu
					greco_hinduism_effect = yes
				}
				100 = {
					show_chance = no
					desc = reform_indo_hellenism.zoroastrian
					greco_zoroastrianism_effect = yes
				}
				100 = {
					show_chance = no
					desc = reform_indo_hellenism.default
					indo_greek_flexibility = yes
					#Always available
				}
			}
		}
		hidden_effect = {
			trigger_event = south_asia.0042
		}
	}
}

indo_greek_culture_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_personal_religious.dds"
	major = yes
	desc = indo_greek_culture_decision_desc
	ai_check_interval = 120

	is_shown = {
		capital_county.title_province = {
			OR = {
				# gotte be kinda sorta near historical indo-greek lands
				geographical_region = world_india_rajastan
				geographical_region = custom_indo_greek_kingdom
			}
		}
		OR = {
			# Needs to be either Indo-Aryan or have some kind of Greek cultural roots
			culture = { has_cultural_pillar = heritage_indo_aryan }
			culture = { any_parent_culture_or_above = { this = culture:greek } }
			culture = { has_cultural_pillar = language_greek }
			# Or at least speek Greek
			knows_language = language_greek
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:indo_greek_culture_decision
			}
		}
	}

	is_valid = {
		# Famous
		prestige_level >= 3
		# Speeks Greek
		knows_language = language_greek
		# Greeks (or post-greeks) and Indo-Aryans coexist within your realm
		OR = {
			AND = {
				any_powerful_vassal = {
					culture = {
						OR = {
							this = culture:greek
							any_parent_culture_or_above = { this = culture:greek }
							has_cultural_pillar = language_greek
						}
					}
				}
				any_powerful_vassal = {
					culture = { has_cultural_pillar = heritage_indo_aryan }
				}
			}
			AND = {
				any_sub_realm_county = {
					culture = {
						OR = {
							this = culture:greek
							any_parent_culture_or_above = { this = culture:greek }
							has_cultural_pillar = language_greek
						}
					}
				}
				any_sub_realm_county = {
					culture = { has_cultural_pillar = heritage_indo_aryan }
				}
			}

		}
	}

	is_valid_showing_failures_only = {
		is_available_at_peace_adult = yes
	}

	effect = {
		show_as_tooltip = {
			indo_greek_culture_decision_effect = yes
			random_list = {
				100 = {
					show_chance = no
					desc = spiritualist_yavana
					culture:indo_greek = {
						set_culture_pillar = ethos_spiritual
						add_culture_tradition = tradition_mendicant_mystics
					}					
				}
				100 = {
					show_chance = no
					desc = bureaucratic_yavana
					culture:indo_greek = {
						set_culture_pillar = ethos_bureaucratic
						add_culture_tradition = tradition_roman_legacy
					}
				}
			}
		}
		hidden_effect = {
			trigger_event = south_asia.0043
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:indo_greek_culture_decision
			}
		}
	}
}

establish_indian_kingdom_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_personal_religious.dds"
	major = yes
	desc = establish_indian_kingdom_decision_desc

	ai_check_interval = 120

	is_shown = {
		any_realm_county = {
			title_province = { geographical_region = india_struggle_region } # Need to hold some indian clay
		}
		# Interloper in the Indian Struggle
		any_character_struggle = {
			involvement = interloper
			is_struggle_type = indian_struggle
		}
	}

	is_valid = {
		OR = { # Must from an uninvolved religion or culture
			NOT = { struggle:indian_struggle = { is_culture_involved_in_struggle = ROOT.culture } }
			NOT = { struggle:indian_struggle = { is_faith_involved_in_struggle = ROOT.faith } }
		}
		OR = {
			# Need to hold a kingdom or empire in the Indian Struggle region
			any_held_title = {
				any_in_de_jure_hierarchy = {
					title_province = { geographical_region = india_struggle_region } 
				}
				tier >= tier_kingdom
			}
			# Or we can make an exception for Ghaznavids or their alt-historical replacements
			has_primary_title = title:k_kabulistan
		}
	}

	effect = {
		if = {
			limit = { NOT = {ROOT = { is_culture_involved_in_struggle = culture }} }
			# TODO: Culture nickname
			struggle:indian_struggle = { set_culture_as_involved = root.culture }
		}
		if = {
			limit = { NOT = {ROOT = { is_faith_involved_in_struggle = faith }} }
			# TODO: Culture nickname
			struggle:indian_struggle = { set_faith_as_involved = root.faith }
		}
		add_prestige = major_prestige_gain
	}
}

take_stewardship_of_the_sacred_river_decision = {# Become Lord/Lady of the Sacred River
	picture = "gfx/interface/illustrations/decisions/dharma_decision_sacred_rivers.dds"
	major = yes
	ai_check_interval = 120
	desc = take_stewardship_of_the_sacred_river_decision_desc

	is_shown = {
		OR = {
			religion = religion:hinduism_religion
			religion = religion:buddhism_religion
			religion = religion:jainism_religion
			religion = religion:indian_religion
			faith = { has_doctrine = tenet_eastern_syncretism }
		}
		highest_held_title_tier >= tier_duchy
		NOT = { has_character_modifier = ruler_of_the_ganges_modifier }
	}

	is_valid = {
		completely_controls_region = custom_ganges_plain
		custom_description = {
			text = capital_province_in_ganges_region
			capital_province = { geographical_region = custom_ganges_plain }
		}
		prestige_level >= 3
		piety_level >= 1
		custom_tooltip = {
			text = DOMINANT_RELIGION_TRIGGER
			#india_struggle_dominant_phase_trigger = yes	
		}
	}

	is_valid_showing_failures_only = {
		is_adult = yes
		is_available = yes
		trigger_if = {
			limit = { has_global_variable = ruler_of_ganges }
			custom_description = {
				text = capital_province_in_ganges_region
				NOR = {
					AND = {
						global_var:ruler_of_ganges = {
							is_alive = yes
							target_is_liege_or_above = root
						}
					}
					AND = {
						global_var:ruler_of_ganges = { is_alive = yes }
						target_is_liege_or_above = global_var:ruler_of_ganges
					}
				}
			}
		}
	}

	cost = {
		piety = {
			value = major_prestige_value
		}
		gold = {
			value = major_gold_value
		}
	}

	effect = {
		show_as_tooltip = {
			take_stewardship_of_the_sacred_river_effect = yes
		}

		save_scope_as = ruler_of_ganges

		trigger_event = south_asia.0011
		add_to_temporary_list = ruler_of_ganges_notification_sent

		if = {
			limit = {
				exists = global_var:ruler_of_ganges
				global_var:ruler_of_ganges = {
					is_alive = yes
				}
			}
			global_var:ruler_of_ganges = {
				trigger_event = {
				 id = south_asia.0013 #Someone else has taken my title
				 days = 3
				}
				add_to_temporary_list = ruler_of_ganges_notification_sent
			}
		}

		if = { #Only send notification the first time the decision is taken
			limit = {
				NOT = { has_global_variable = ruler_of_ganges_notification_sent }
			}
			every_independent_ruler = {
				limit = {
					religion = religion:hinduism_religion
				}
				trigger_event = {
					id = south_asia.0012
					days = 3
				}
				add_to_temporary_list = ruler_of_ganges_notification_sent
			}
			set_global_variable = {
				name = ruler_of_ganges_notification_sent
				value = yes
			}
		}
	}

	ai_will_do = {
		base = 100
	}
}