# No lists or indexes, only chaos. Keep scrolling down and thou shalt find them.

#############################################
# Hostility Ending					    	#
# by Joe Parkin								#
#############################################

struggle_byzantine_ending_hostility_decision = {
	major = yes
	title = struggle_byzantine_ending_hostility_decision
	picture = "gfx/interface/illustrations/decisions/fp2_decision_struggle_hostility.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/fp2_decision_hostility.dds"
	desc = struggle_byzantine_ending_hostility_decision_desc
	selection_tooltip = struggle_byzantine_ending_hostility_decision_tooltip
	is_invisible = yes
	sort_order = 80

	is_shown = {
		has_fp2_dlc_trigger = yes
		exists = struggle:asdac_byzantine_struggle
	}
	
	is_valid = {
		is_independent_ruler = yes
		
		custom_tooltip = {
			text = struggle_ending_decision_correct_involvement_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = asdac_byzantine_struggle
			}
		}
		#custom_tooltip = {
		#	text = struggle_byzantine_ending_hostility_decision_correct_phase_tt
		#	any_character_struggle = {
		#		involvement = involved
		#		is_struggle_type = asdac_byzantine_struggle
		#		is_struggle_phase = struggle_byzantine_phase_hostility
		#	}
		#}

		# Completely control at least 2 of the important duchies
		completely_controls = title:d_thrace
		OR = {
			completely_controls = title:d_opsikion
			completely_controls = title:d_thessalonika
		}
		custom_tooltip = {
			text = you_control_percent_or_more_byzantine_region
			any_county_in_region = {
				region = asdac_byzantine_struggle_region
				percent >= byzantine_struggle_control_threshold_decimal_value
				holder.top_liege = root
			}
		}
		any_county_in_region = {
			region = asdac_byzantine_struggle_region
			percent >= byzantine_struggle_control_threshold_decimal_value
			holder.top_liege = root
		}
		
		# No other realm controls more than 20% of the Iberia region
		custom_tooltip = {
			text = struggle_byzantine_ending_hostility_decision_region_tt
			NOT = {
				struggle:asdac_byzantine_struggle = {
					any_involved_ruler = {
						NOT = { this = root }
						is_independent_ruler = yes
						exists = primary_title
						primary_title = { is_mercenary_company = no }
						save_temporary_scope_as = byzantine_realm
						any_county_in_region = {
							region = asdac_byzantine_struggle_region
							percent > fp2_struggle_hostility_region_percent_decimal_value
							holder.top_liege = scope:byzantine_realm
						}
					}
				}
			}
		}
	}

	effect = {
		title:e_byzantium = { save_scope_as = byzantium }
		##### Major Effects #####
		
		root.dynasty = { add_dynasty_prestige = 2500 }
		struggle:asdac_byzantine_struggle = { end_struggle = yes }
		if = { #Bulgarians and Latin Empire
			limit = { highest_held_title_tier = tier_empire }
			custom_tooltip = {
				text = all_de_jure_byzantine_becomes_latin
				every_kingdom = {
					limit = {
						de_jure_liege = title:e_byzantium
					}
					set_de_jure_liege_title = root.primary_title
				}
			}
		}
		if = {
			limit = {
				NOT = { highest_held_title_tier = tier_empire }
				OR = {
					culture = culture:greek
					culture = { any_parent_culture_or_above = { this = culture:greek } }
				}
				NOT = { culture = culture:ottoman_turkish }
			}
			show_as_tooltip = { create_byzantine_empire_scripted_effect = yes }
			trigger_event = asdac_roman_restoration.1001
		}
		if = {
			limit = {
				culture = culture:ottoman_turkish
			}
			give_nickname = nick_the_conqueror
		}
		if = { #Non-Greek
			limit = {
				NOT = { highest_held_title_tier = tier_empire }
				NOT = { culture = culture:greek }
			}
			create_byzantine_empire_scripted_effect = yes
		}
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

#############################################
# Compromise Ending					    	#
# by Joe Parkin								#
#############################################

struggle_byzantine_ending_compromise_decision = {
	major = yes
	title = struggle_byzantine_ending_compromise_decision
	picture = "gfx/interface/illustrations/decisions/fp2_decision_struggle_compromise.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/fp2_decision_compromise.dds"
	desc = struggle_byzantine_ending_compromise_decision_desc
	selection_tooltip = struggle_byzantine_ending_compromise_decision_tooltip
	is_invisible = yes

	sort_order = 80
	
	is_shown = {
		has_fp2_dlc_trigger = yes
		always = no
	}

	is_valid = {
		is_independent_ruler = yes

		custom_tooltip = {
			text = struggle_byzantine_ending_compromise_decision_correct_phase_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = asdac_byzantine_struggle
				is_struggle_phase = struggle_byzantine_phase_compromise
			}
		}
		
		always = no
	}

	effect = {
		##### Major Effects #####
		#show_as_tooltip = {
		#	fp2_struggle_compromise_ender_effect = yes
		#}
		fp2_struggle_compromise_ender_effect = yes
		struggle:asdac_byzantine_struggle = { end_struggle = yes }
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}

#############################################
# Conciliation Ending					    #
# by Joe Parkin								#
#############################################

struggle_byzantine_ending_conciliation_decision = {
	major = yes
	title = struggle_byzantine_ending_conciliation_decision
	picture = "gfx/interface/illustrations/decisions/fp2_decision_struggle_conciliation.dds"
	extra_picture = "gfx/interface/illustrations/struggle_decisions_buttons/fp2_decision_conciliation.dds"
	desc = struggle_byzantine_ending_conciliation_decision_desc
	selection_tooltip = struggle_byzantine_ending_conciliation_decision_tooltip
	is_invisible = yes

	sort_order = 80
	
	is_shown = {
		has_fp2_dlc_trigger = yes
		always = no
	}

	is_valid = {
		is_independent_ruler = yes

		custom_tooltip = {
			text = struggle_byzantine_ending_conciliation_decision_correct_phase_tt
			any_character_struggle = {
				involvement = involved
				is_struggle_type = asdac_byzantine_struggle
				is_struggle_phase = struggle_byzantine_phase_conciliation
			}
		}

		always = no
	}

	effect = {
		##### Major Effects #####
		#show_as_tooltip = {
		#	fp2_struggle_conciliation_ender_effect = yes
		#}
		fp2_struggle_conciliation_ender_effect = yes
		struggle:asdac_byzantine_struggle = { end_struggle = yes }
	}

	cost = {}

	ai_check_interval = 120

	ai_potential = { always = yes }

	ai_will_do = { base = 100 }
}