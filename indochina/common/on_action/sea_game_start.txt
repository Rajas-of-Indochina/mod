# Called from code after history generation
# Empty scope
on_game_start = {
    on_actions = {
        set_tributaries_on_game_start
        holy_site_buildings_on_game_start
    }
    events = {
        rivers_events.0001
    }
}

on_game_start_after_lobby = {
    on_actions = {
        set_cultural_succession_laws
    }
}

######

holy_site_buildings_on_game_start = {

    effect = {
        every_religion_global = {
            limit = {
                is_in_family = rf_animism
            }
            every_faith = {
                every_holy_site = {
                    limit = {
                        title_province = {
                            has_special_building_slot = no
                        }
                    }
                    title_province = {
                        add_special_building_slot = holy_site_pagan_grand_temple_01 # Should make a unique version of this for animists
                    }
                }
            }
        }
    }
}

set_tributaries_on_game_start = {

    effect = {

        if = {
            limit = { game_start_date = 867.1.1 }

            ## Set tributaries
            # Srivijaya
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_srivijaya.holder
                    TRIBUTARY = title:d_tanjungpura.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_srivijaya.holder
                    TRIBUTARY = title:c_panai.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_srivijaya.holder
                    TRIBUTARY = title:c_nagur.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_srivijaya.holder
                    TRIBUTARY = title:d_lamuri.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_srivijaya.holder
                    TRIBUTARY = title:d_wijayapura.holder
                }

            # Nanzhao
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_myitkyina.holder
                    TRIBUTARY = title:c_mongyang.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_yongchang.holder
                    TRIBUTARY = title:c_putao.holder
                }
                # Beikthano
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_beikthano.holder
                    TRIBUTARY = title:c_magwe.holder
                }
                # Yinsheng
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_kainan.holder
                    TRIBUTARY = title:d_kengtung.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_kainan.holder
                    TRIBUTARY = title:d_phongsali.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_kainan.holder
                    TRIBUTARY = title:c_chiang_hung.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_kainan.holder
                    TRIBUTARY = title:c_meng_laa.holder
                }
                # Tonghai
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_tonghai.holder
                    TRIBUTARY = title:c_hohoxe.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_tonghai.holder
                    TRIBUTARY = title:c_vunsanh.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_tonghai.holder
                    TRIBUTARY = title:c_tu_long.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_tonghai.holder
                    TRIBUTARY = title:c_bao_lac.holder
                }


            # Shan
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_yawnghwe.holder
                    TRIBUTARY = title:c_yawnghwe.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_laikha.holder
                    TRIBUTARY = title:c_mongkung.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_north_shan.holder
                    TRIBUTARY = title:c_manglon.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_kengtung.holder
                    TRIBUTARY = title:c_chiang_hung.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_chiang_hung.holder
                    TRIBUTARY = title:c_meng_laa.holder
                }

            # Mon
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_thaton.holder
                    TRIBUTARY = title:c_pegu.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:c_hpa_an.holder
                    TRIBUTARY = title:c_kawkareik.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:d_thaton.holder
                    TRIBUTARY = title:c_hpapun.holder
                }

            # Kambuja
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:e_kambujadesa.holder
                    TRIBUTARY = title:d_nakhon_phanom.holder
                }

            # Annam
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:d_nong.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_tu_long.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_thuy_vi.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_lo.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_tra_lan.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_quynh_nhai.holder
                }
                make_tributary = {
                    TYPE = tributary_permanent
                    SUZERAIN = title:k_jinghai.holder
                    TRIBUTARY = title:c_yen_lo.holder
                }
        }

        if = {
            limit = { game_start_date = 1066.9.15 }

            ## Set tributaries
            # Pagan
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:d_arakan.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:c_hsipaw.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:d_north_shan.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:d_mongpai.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:c_kale.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:c_kale.holder
                TRIBUTARY = title:c_thaungdut.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:k_pagan.holder
                TRIBUTARY = title:c_bhamo.holder
            }
            make_tributary = {
                TYPE = tributary_permanent
                SUZERAIN = title:c_takon.holder
                TRIBUTARY = title:c_mongyang.holder
            }
        }
    }
}

set_cultural_succession_laws = {

    effect = {

        every_ruler = {
            if = { # Barangay
                limit = {
                    culture_group = culture_group:filipino_group
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = barangay_elective_succession_law
                    }
                }
            }
            else_if = { # Tanistry
                limit = {
                    OR = {
                        culture_group = culture_group:brythonic_group
                        culture_group = culture_group:goidelic_group
                    }
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = gaelic_elective_succession_law
                    }
                }
            }
            else_if = { # Thing
                limit = {
                    culture_group = culture_group:north_germanic_group
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = scandinavian_elective_succession_law
                    }
                }
            }
            else_if = { # Witenagemot
                limit = {
                    culture = culture:anglo_saxon
                    highest_held_title_tier >= tier_kingdom
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_kingdom
                        }
                        add_title_law = saxon_elective_succession_law
                    }
                }
            }
        }
    }
}