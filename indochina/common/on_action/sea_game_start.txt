# Called from code after history generation
# Empty scope
on_game_start = {
    on_actions = {
        holy_site_buildings_on_game_start
        holy_site_descriptions_on_game_start
    }
    events = {
        rivers_events.0001
    }
}

on_game_start_after_lobby = {
    on_actions = {
        set_cultural_succession_laws
        ruler_popup_events
    }
}

######

holy_site_descriptions_on_game_start = {
    effect = {

        title:b_albay = {
            set_variable = {
                name = holy_site_description
                value = flag:holy_site_mount_mayon_description
            }
        }
    }
}

######

holy_site_buildings_on_game_start = {

    effect = {
        every_religion_global = {
            limit = {
                is_in_family = rf_animism
            }
            every_faith = {
                every_holy_site = {
                    limit = {
                        title_province = {
                            has_special_building_slot = no
                        }
                    }
                    title_province = {
                        add_special_building_slot = holy_site_pagan_grand_temple_01 # Should make a unique version of this for animists
                    }
                }
            }
        }
    }
}

set_cultural_succession_laws = {

    effect = {

        every_ruler = {
            if = { # Barangay
                limit = {
                    culture_group = culture_group:filipino_group
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = barangay_elective_succession_law
                    }
                }
            }
            else_if = { # Tanistry
                limit = {
                    OR = {
                        culture_group = culture_group:brythonic_group
                        culture_group = culture_group:goidelic_group
                    }
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = gaelic_elective_succession_law
                    }
                }
            }
            else_if = { # Thing
                limit = {
                    culture_group = culture_group:north_germanic_group
                    highest_held_title_tier >= tier_duchy
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_duchy
                        }
                        add_title_law = scandinavian_elective_succession_law
                    }
                }
            }
            else_if = { # Witenagemot
                limit = {
                    culture = culture:anglo_saxon
                    highest_held_title_tier >= tier_kingdom
                }
                every_held_title = {
                    if = {
                        limit = {
                            tier >= tier_kingdom
                        }
                        add_title_law = saxon_elective_succession_law
                    }
                }
            }
        }
    }
}

######

ruler_popup_events = {
    effect = {
        every_ruler = {
            if = {
                limit = { is_ai = no }
                trigger_event = {
                    id = ruler_popups.0000
                }
            }
        }
    }
}