
on_title_gain = {
	events = {
		delay = { days = 1 }
		# Get regnal name
		sea_title_event.0001
	}
}

on_title_gain = {
	events = {
		sea_title_event.1000 # Convert baronies from republic to liege gov
		sea_title_event.1001 # Convert Chinese vassals to appropriate vassal gov
	}
}

# A title is lost by a character
# root = the old holder
# scope:title = the title that changes hands
# scope:new_holder = new holder.
on_title_lost = {
	events = {
		sea_nomad_title_event.0001 # If losing your capital, convert it to an empty holding, and establish a new capital
	}
}

# This is a completely normal use of this function
on_faith_monthly = {
	on_actions = {
		check_nomadic_capital_buildings_pulse
	}
}

check_nomadic_capital_buildings_pulse = {
	effect = {
		every_faith_ruler = {
			limit = {
				has_government = nomadic_government
				highest_held_title_tier > tier_barony
			}
			trigger_event = sea_nomad_title_event.0002 # Check nomad has a capital building. Build it if not.
		}
	}
}

# root: The province in which the building was completed
on_building_completed = {
	on_actions = {
		check_nomadic_capital_moved_in_county
	}
}

check_nomadic_capital_moved_in_county = {
	trigger = {
		county_controller = {
			has_government = nomadic_government
		}
		has_holding_type = nomadic_holding
	}

	effect = {
		# Make this the title province
		barony = { set_capital_barony = yes }

		# Remove the old capital
		county = {
			every_county_province = {
				limit = {
					has_holding_type = nomadic_holding
					NOT = { this = root }
				}
				county_controller = { destroy_title = prev }
				# remove_holding = yes
				# remove_building = nomadic_01
			}
		}

		# Flag character as having moved their capital
		county_controller = {
			set_variable = {
				name = has_moved_capital value = yes days = 3650 # 10 years
			}
		}
	}
}