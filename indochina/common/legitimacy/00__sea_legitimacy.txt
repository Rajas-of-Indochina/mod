######################
# Legitimacy
######################

count_mandala_legitimacy = {
	is_valid = {
		highest_held_title_tier = tier_county
		has_government = mandala_government
	}

	ai_expected_level = default_ai_legitimacy_expectation

	below_expectations_opinion = default_legitimacy_opinion_penalty

	max = legitimacy_max

	level = {
		threshold = legitimacy_level_1
		modifier = {
			vassal_tax_contribution_mult = -0.1
			monthly_piety_gain_mult = -0.1
			vassal_opinion = -10
		}
		flag = reduced_vassalization_acceptance
		flag = increased_factions
	}
	# Gap of at least 50
	level = {
		threshold = legitimacy_level_2 # 50-200
		modifier = {
			vassal_tax_contribution_mult = 0.05
		}
	}
	# Gap of at least 100
	level = {
		threshold = legitimacy_level_3 # 150-600
		modifier = {
			vassal_tax_contribution_mult = 0.1
		}
	}
	# Gap of at least 200
	level = {
		threshold = legitimacy_level_4 # 350-1400
		modifier = {
			vassal_tax_contribution_mult = 0.15
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.1
			powerful_vassal_opinion = 10
		}
		flag = reduced_factions
		flag = reduced_title_creation_cost
	}
	# Gap of at least 350
	level = {
		threshold = legitimacy_level_5 # 700-2800
		modifier = {
			vassal_tax_contribution_mult = 0.25
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.25
			powerful_vassal_opinion = 20
		}
		flag = very_reduced_factions
		flag = very_reduced_title_creation_cost
	}
	# Gap of at least 500
	level = {
		threshold = legitimacy_level_6 # 1200-4800
		modifier = {
			vassal_tax_contribution_mult = 0.5
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.5
			powerful_vassal_opinion = 30
		}
		flag = extra_reduced_factions
		flag = extra_reduced_title_creation_cost
	}
}

duke_mandala_legitimacy = {
	is_valid = {
		highest_held_title_tier = tier_duchy
		has_government = mandala_government
	}

	ai_expected_level = default_ai_legitimacy_expectation

	below_expectations_opinion = default_legitimacy_opinion_penalty

	max = legitimacy_max

	level = {
		threshold = legitimacy_level_1
		modifier = {
			vassal_tax_contribution_mult = -0.15
			monthly_piety_gain_mult = -0.1
			vassal_opinion = -10
		}
		flag = very_reduced_vassalization_acceptance
		flag = very_increased_factions
	}
	# Gap of at least 50
	level = {
		threshold = legitimacy_level_2 # 50-200
		modifier = {
			vassal_tax_contribution_mult = -0.05
			vassal_opinion = -5
		}
		flag = reduced_vassalization_acceptance
		flag = increased_factions
	}
	# Gap of at least 100
	level = {
		threshold = legitimacy_level_3 # 150-600
		modifier = {
			vassal_tax_contribution_mult = 0.1
		}
	}
	# Gap of at least 200
	level = {
		threshold = legitimacy_level_4 # 350-1400
		modifier = {
			vassal_tax_contribution_mult = 0.15
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.15
		}
		flag = increased_vassalization_acceptance
		flag = reduced_factions
		flag = reduced_title_creation_cost
	}
	# Gap of at least 350
	level = {
		threshold = legitimacy_level_5 # 700-2800
		modifier = {
			vassal_tax_contribution_mult = 0.2
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.2
			powerful_vassal_opinion = 10
		}
		flag = very_increased_vassalization_acceptance
		flag = very_reduced_factions
		flag = very_reduced_title_creation_cost
	}
	# Gap of at least 500
	level = {
		threshold = legitimacy_level_6 # 1200-4800
		modifier = {
			vassal_tax_contribution_mult = 0.5
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.25
			powerful_vassal_opinion = 20
		}
		flag = extra_reduced_factions
		flag = extra_reduced_title_creation_cost
	}
}

king_mandala_legitimacy = {
	is_valid = {
		highest_held_title_tier = tier_kingdom
	}

	ai_expected_level = default_ai_legitimacy_expectation

	below_expectations_opinion = default_legitimacy_opinion_penalty

	max = legitimacy_max

	level = {
		threshold = legitimacy_level_1
		modifier = {
			vassal_tax_contribution_mult = -0.25
			monthly_piety_gain_mult = -0.2
			vassal_opinion = -20
		}
		flag = very_reduced_vassalization_acceptance
		flag = very_increased_factions
	}
	# Gap of at least 50
	level = {
		threshold = legitimacy_level_2 # 50-200
		modifier = {
			vassal_tax_contribution_mult = -0.15
			monthly_piety_gain_mult = -0.1
			vassal_opinion = -10
		}
		flag = reduced_vassalization_acceptance
		flag = increased_factions
	}
	# Gap of at least 100
	level = {
		threshold = legitimacy_level_3 # 150-600
		modifier = {
			vassal_tax_contribution_mult = -0.1
		}
		flag = reduced_vassalization_acceptance
	}
	# Gap of at least 200
	level = {
		threshold = legitimacy_level_4 # 350-1400
		modifier = {
			vassal_tax_contribution_mult = 0.05
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.1
		}
	}
	# Gap of at least 350
	level = {
		threshold = legitimacy_level_5 # 700-2800
		modifier = {
			vassal_tax_contribution_mult = 0.1
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.2
		}

		flag = increased_vassalization_acceptance
		flag = reduced_factions
		flag = reduced_title_creation_cost
	}
	# Gap of at least 500
	level = {
		threshold = legitimacy_level_6 # 1200-4800
		modifier = {
			vassal_tax_contribution_mult = 0.25
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.25
			powerful_vassal_opinion = 10
		}
		flag = very_increased_vassalization_acceptance
		flag = very_reduced_factions
		flag = very_reduced_title_creation_cost
	}
}

empire_mandala_legitimacy = {
	is_valid = {
		highest_held_title_tier = tier_empire
	}

	ai_expected_level = default_ai_legitimacy_expectation

	below_expectations_opinion = default_legitimacy_opinion_penalty

	max = legitimacy_max

	level = {
		threshold = legitimacy_level_1
		modifier = {
			vassal_tax_contribution_mult = -0.5
			monthly_piety_gain_mult = -0.25
			vassal_opinion = -30
		}
		flag = massively_reduced_vassalization_acceptance
		flag = massively_increased_factions
	}
	# Gap of at least 50
	level = {
		threshold = legitimacy_level_2 # 50-200
		modifier = {
			vassal_tax_contribution_mult = -0.2
			monthly_piety_gain_mult = -0.2
			vassal_opinion = -20
		}
		flag = very_reduced_vassalization_acceptance
		flag = very_increased_factions
	}
	# Gap of at least 100
	level = {
		threshold = legitimacy_level_3 # 150-600
		modifier = {
			vassal_tax_contribution_mult = -0.1
			monthly_piety_gain_mult = -0.1
			vassal_opinion = -10
		}
		flag = reduced_vassalization_acceptance
		flag = increased_factions
	}
	# Gap of at least 200
	level = {
		threshold = legitimacy_level_4 # 350-1400
		modifier = {
			vassal_tax_contribution_mult = -0.05
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.5
		}
		flag = reduced_vassalization_acceptance
	}
	# Gap of at least 350
	level = {
		threshold = legitimacy_level_5 # 700-2800
		modifier = {
			vassal_tax_contribution_mult = 0.05
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.1
		}
	}
	# Gap of at least 500
	level = {
		threshold = legitimacy_level_6 # 1200-4800
		modifier = {
			vassal_tax_contribution_mult = 0.15
			monthly_piety_gain_per_happy_powerful_vassal_add = 0.2
			powerful_vassal_opinion = 10
		}
		flag = increased_vassalization_acceptance
		flag = reduced_factions
		flag = reduced_title_creation_cost
	}
}
