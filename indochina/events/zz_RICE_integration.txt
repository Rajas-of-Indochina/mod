namespace = normandy
namespace = sus
namespace = tarim_basin
namespace = siberia
namespace = pamir
namespace = sri_lanka

# NORMANDY STRUGGLE INTRO Just to shush errors
normandy.0001 = { # Fullscreen Intro Event
	type = character_event
	window = fullscreen_event
	title = normandy.0001.t
	desc = {
		first_valid = {
			# If done through granting
			triggered_desc = {
				trigger = {
					is_target_in_global_variable_list = {
						name = unavailable_unique_decisions
						target = flag:RICE_normandy_granted_to_norse_already
					}
				}
				desc = normandy.0001.desc.RICE
			}
			# If done through other means
			desc = normandy.0001.desc.vanilla
		}
	}
	theme = diplomacy_foreign_affairs_focus
	trigger = { # we need to prevent this from firing for all players when a new player joins in MP
		is_ai = no
		NOT = { has_character_flag = RICE_normandy_struggle_intro_event_flag }
		OR = {
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_normandy_struggle
			}
			any_character_struggle = {
				involvement = interloper
				is_struggle_type = RICE_normandy_struggle
			}
		}
 	}
	override_background = { reference = RICE_normandy_struggle_start }
	override_sound = { reference = "event:/DLC/FP2/SFX/UI/fp2_struggle_ui_intro_animate" }

	widgets = {
		widget = {
 			gui = "event_window_widget_struggle_info"
 			container = "dynamic_content_widget"
 			controller = struggle_info
 			setup_scope = { struggle:RICE_normandy_struggle = { save_scope_as = struggle } }
		}
	}
	immediate = {
		play_music_cue = "mx_cue_combat_3"
		add_character_flag = RICE_normandy_struggle_intro_event_flag
		culture:norman = {
			save_scope_as = norman
		}
		save_scope_value_as = {
			name = start
			value = yes
		}
		ordered_in_global_list = {
			variable = RICE_normandy_rollo_list
			save_scope_as = rollo
		}
		if = {
			limit = {
				is_target_in_global_variable_list = {
					name = unavailable_unique_decisions
					target = flag:RICE_normandy_granted_to_norse_already
				}
			}
			ordered_in_global_list = {
				variable = RICE_normandy_charles_list
				save_scope_as = charles
			}
		}
	}

	option = {
		name = normandy.0001.a
		trigger = {
			any_character_struggle = {
				involvement = involved
				is_struggle_type = RICE_normandy_struggle
			}
		}
		clicksound = "event:/DLC/FP2/SFX/UI/fp2_struggle_start_select"
	}

	option = {
		name = normandy.0001.b
		trigger = {
			any_character_struggle = {
				involvement = interloper
				is_struggle_type = RICE_normandy_struggle
			}			
		}
		clicksound = "event:/DLC/FP2/SFX/UI/fp2_struggle_start_select"
	}

	after = {
		# If you are Rollo
		if = {
			limit = {
				has_character_modifier = RICE_normandy_rollo_modifier
				NOT = { has_character_flag = RICE_normandy_rollo_concluding_event_done }
			}
			trigger_event = normandy.0086
		}
	}

}

# Add Norse, Fr*nch and Asatru minorities in Normandy
normandy.0041 = {
	type = character_event
	title = normandy.0041.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					root = scope:rollo
				}
				desc = normandy.0041.desc.rollo
			}
			desc = normandy.0041.desc # Defaults to French King's perspective
		}
	}
	theme = RICE_theme_normandy_castle
	override_icon = { reference = "gfx/interface/icons/event_types/type_diplomacy.dds" }
	
	left_portrait = {
		character = scope:charles
		animation = war_over_tie
	}
	
	right_portrait = {
		character = scope:rollo
		animation = personality_callous
	}

	immediate = {
		custom_tooltip = establish_norman_culture_decision_effect.tt.2
		
		# Summary of above hidden effects to inform players of the decision's impact.
		show_as_tooltip = {
			custom_tooltip = establish_norman_culture_decision_effect.tt
			culture:norman = {
				get_all_innovations_from = scope:old_culture_1
				get_all_innovations_from = scope:old_culture_2
			}
			scope:charles = {
				pay_short_term_gold = {
					target = scope:rollo
					gold = medium_gold_value
				}
			}
			scope:rollo = {
				add_prestige = 500
				set_culture = culture:norman
				add_character_flag = converted_culture_this_lifetime
				get_title = title:c_rouen
				get_title = title:d_normandy
				if = {
					limit = {
						scope:rollo = {
							has_character_flag = RICE_normandy_rollo_did_convert_flag
						}
					}
					set_character_faith_with_conversion = scope:charles.faith
				}
				dynasty = {
					add_dynasty_modifier = {
						modifier = RICE_normandy_rollo_family_equivalent
					}
				}
			}
		}

	}
	
	option = { # ok
		name = normandy.0041.a
		trigger = {
			root = scope:charles
		}
	}
	
	option = { # ok
		name = normandy.0041.b
		trigger = {
			root = scope:charles
			is_ai = no
		}
		set_player_character = scope:rollo
		# scope:rollo = {
		# 	trigger_event = normandy.0001
		# }
	}
	
	option = { # ok
		name = normandy.0041.c
		trigger = {
			root = scope:rollo
		}
	}

	after = {
		# if = {
		# 	limit = {
		# 		exists = scope:original_liege
		# 	}
		# 	# Notify original liege
		# 	scope:original_liege = {
		# 		trigger_event = normandy.0042
		# 	}
		# }
		scope:rollo = {
			trigger_event = normandy.0001
			every_sub_realm_county = {
				save_scope_as = rollo_county
				add_culture_minority_effect = { COUNTY = scope:rollo_county CULTURE = scope:rollo_old_culture SIZE = small }
				add_culture_minority_effect = { COUNTY = scope:rollo_county CULTURE = culture:french SIZE = small }
				random = {
					chance = 50
					add_faith_minority_effect = { COUNTY = scope:rollo_county FAITH = scope:rollo_old_faith SIZE = small }
				}
			}
		}
		if = {
			limit = {				
				scope:rollo = {
					has_character_flag = RICE_normandy_rollo_did_convert_flag
				}
			}
			scope:rollo = {
				remove_character_flag = RICE_normandy_rollo_did_convert_flag
			}
		}
		# Notification event rulers other than Rollo or Charles equivalents
		every_ruler = {
			limit = {
				NOT = { this = scope:rollo }
				NOT = { this = scope:charles }
				OR = {
					AND = {
						exists = scope:original_liege
						this = scope:original_liege
					}
					any_held_title = {
						tier = tier_county
						any_county_province = {
							#OR = {
								geographical_region = world_europe
								#geographical_region = world_europe_west
								#geographical_region = world_europe_north
								#geographical_region = world_europe_south_italy
							#}
						}
					}
				}
			}
			trigger_event = normandy.0042
		}		
	}

}

# Notify people about Rollo's arrival in Normandy (error shusher)
normandy.0042 = {
	type = character_event
	title = normandy.0042.t
	desc = normandy.0042.desc
	theme = RICE_theme_normandy_castle
	override_icon = { reference = "gfx/interface/icons/event_types/type_diplomacy.dds" }
	
	left_portrait = {
		character = scope:charles
		animation = war_over_tie
	}
	
	right_portrait = {
		character = scope:rollo
		animation = personality_callous
	}

	immediate = {
		play_music_cue = "mx_cue_combat_3"
	}
	
	option = { # Ok
		name = normandy.0042.a
		custom_tooltip = normandy.0042.tooltip.struggle_started
		custom_tooltip = establish_norman_culture_decision_effect.tt
		custom_tooltip = establish_norman_culture_decision_effect.tt.2
		if = {
			limit = {
				exists = scope:original_liege
				root = scope:original_liege
			}
			custom_tooltip = normandy.0042.tooltip.old_liege
		}
	}
}

# More error shushing
# Rollo - concluding event
normandy.0086 = {
	type = character_event
	title = normandy.0086.t
	desc = normandy.0086.desc
	theme = RICE_theme_normandy_castle

	right_portrait = {
		character = scope:rollo
		animation = war_over_win
	}

	immediate = {
		# if = {
		# 	limit = {
		# 		this = character:242
		# 	}
		# }
		# character:242 = {
		# 	is_landed = yes
		# 	has_character_modifier = RICE_normandy_rollo_modifier
		# 	has_character_flag = RICE_normandy_rollo_big_dream
		# }
		add_character_flag = RICE_normandy_rollo_concluding_event_done
	}
	
	option = { # Religious
		name = normandy.0086.a
		add_piety = 200
		if = {
			limit = {
				exists = dynasty
			}
			dynasty = {
				add_dynasty_prestige = 250
			}
		}
		random_list = {
			30 = { }
			40 = {
				if = {
					limit = {
						has_trait = cynical
					}
					remove_trait = cynical
				}
				add_trait = zealous
			}
			15 = {
				if = {
					limit = {
						has_trait = impatient
					}
					remove_trait = impatient
				}
				add_trait = patient
			}
			15 = {
				if = {
					limit = {
						has_trait = ambitious
					}
					remove_trait = ambitious
				}
				add_trait = content
			}
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_description_no_bullet = {
				text = normandy.0086.info
			}
		}
	}
	
	option = { # Glory
		name = normandy.0086.b
		add_prestige = 200
		if = {
			limit = {
				exists = dynasty
			}
			dynasty = {
				add_dynasty_prestige = 250
			}
		}
		random_list = {
			30 = { }
			40 = {
				if = {
					limit = {
						has_trait = content
					}
					remove_trait = content
				}
				add_trait = ambitious
			}
			15 = {
				if = {
					limit = {
						has_trait = generous
					}
					remove_trait = generous
				}
				add_trait = greedy
			}
			15 = {
				if = {
					limit = {
						has_trait = compassionate
					}
					remove_trait = compassionate
				}
				add_trait = callous
			}
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_description_no_bullet = {
				text = normandy.0086.info
			}
		}
	}
	
	option = { # People
		name = normandy.0086.c
		add_prestige = 100
		add_piety = 100
		if = {
			limit = {
				exists = dynasty
			}
			dynasty = {
				add_dynasty_prestige = 250
			}
		}
		random_list = {
			30 = { }
			30 = {
				if = {
					limit = {
						has_trait = arbitrary
					}
					remove_trait = arbitrary
				}
				add_trait = just
			}
			15 = {
				if = {
					limit = {
						has_trait = callous
					}
					remove_trait = callous
				}
				if = {
					limit = {
						has_trait = sadistic
					}
					remove_trait = sadistic
				}
				add_trait = compassionate
			}
			15 = {
				if = {
					limit = {
						has_trait = lazy
					}
					remove_trait = lazy
				}
				add_trait = diligent
			}
			10 = {
				if = {
					limit = {
						has_trait = greedy
					}
					remove_trait = greedy
				}
				add_trait = generous
			}
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_description_no_bullet = {
				text = normandy.0086.info
			}
		}
	}

}

######################################################################################
# 
# MERCHANT COURTIER SPAWN
# Changes: Minority of merchant's culture now appears in a random realm county if you recruit them
# 
######################################################################################


# Trans-Saharan Arab Merchant offers services or at least a good deal (can spawn anywhere [GetGeographicalRegion('world_africa').GetName])
sus.0030 = {
	type = character_event
	title = sus.0030.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_sus_currently_trans_saharan_networking
				}
				desc = sus.0030.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = RICE_sus_currently_trans_saharan_networking }
				}
				desc = sus.0030.desc.intro_normal
			}			
		}
		desc = sus.0030.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = throne_room }
	
	
	left_portrait = {
		character = scope:RICE_trans_saharan_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = world_africa
		}
		NOT = { has_character_flag = RICE_trans_saharan_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.7
			capital_province = {
				geographical_region = ghw_region_subsahelian_africa
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = RICE_trans_saharan_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				has_government = tribal_government
			}
		}
		modifier = {
			add = 1.1
			dynasty = {
				has_dynasty_perk = RICE_trans_saharan_trade_legacy_1
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_RICE_gold_dust_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = RICE_trans_saharan_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = RICE_trans_saharan_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = RICE_trans_saharan_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = RICE_trans_saharan_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = RICE_trans_saharan_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = RICE_trans_saharan_already_spawned_merchant

		if = {
			limit = {
				any_county_in_region = {
					region = world_innovation_camels
					OR = {
						culture = { has_cultural_pillar = heritage_arabic }
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_kemetic }
						}
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_semitic }
						}
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_levantine }
						}
					}
				}
			}
			every_county_in_region = {
				region = world_innovation_camels
				limit = {
					OR = {
						culture = { has_cultural_pillar = heritage_arabic }
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_kemetic }
						}
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_semitic }
						}
						AND = {
							has_global_variable = RICE_game_started_on_TFE_start_date
							culture = { has_cultural_pillar = heritage_levantine }
						}
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
			}
			create_character = {
				location = root.location
				template = RICE_trans_saharan_merchant_template
				save_scope_as = RICE_trans_saharan_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			if = {
				limit = {
					has_global_variable = RICE_game_started_on_TFE_start_date
				}
				random_list = {
					# Egyptian
					# Bedouin
					10 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:kemitic
							faith = faith:nicene
						}				
					}
					10 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:aegyptian
							faith = faith:nicene
						}				
					}
					10 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:bedouin
							faith = faith:arabic_pagan
						}				
					}
					10 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:aramean
							faith = faith:nicene
						}				
					}
				}
			}
			else = {
				random_list = {
					# Maghreb
					# Andalusian
					# Egyptian
					# Levantine
					# Bedouin
					# Yemeni
					15 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:maghrebi
							faith = faith:ashari
						}			
					}
					5 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:maghrebi
							faith = faith:ibadi
						}				
					}
					20 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:andalusian
							faith = faith:muwalladi
						}				
					}
					5 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:egyptian
							faith = faith:coptic
						}				
					}
					15 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:egyptian
							faith = faith:ismaili
						}				
					}
					20 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:levantine
							faith = faith:ashari
						}				
					}
					20 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:bedouin
							faith = faith:ashari
						}				
					}
					20 = {
						create_character = {
							location = root.location
							template = RICE_trans_saharan_merchant_template
							save_scope_as = RICE_trans_saharan_merchant_spawn
							culture = culture:yemeni
							faith = faith:ashari
						}				
					}
				}
			}
		}

		hidden_effect = {
			scope:RICE_trans_saharan_merchant_spawn = {
				RICE_sus_determine_merchant_skill_effect = yes
			}
		}
	}

	# Okay
	option = {
		name = sus.0030.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:RICE_trans_saharan_merchant_spawn
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_arab_merchants
			years = 10
		}
		random_realm_county = {
			if = {
				limit = { NOT = { culture = scope:RICE_trans_saharan_merchant_spawn.culture } }
				save_scope_as = county
				promote_culture_minority_effect = {
					CULTURE = scope:RICE_trans_saharan_merchant_spawn.culture
				}
			}
		}
		hidden_effect = {
			random = {
				chance = 50
				RICE_generate_small_family = { CHARACTER = scope:RICE_trans_saharan_merchant_spawn }
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = sus.0030.b
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_arab_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = sus.0030.c
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = RICE_sus_currently_trans_saharan_networking
			}
			RICE_sus_clean_up_trans_saharan_merchant_effect = yes
		}
	}
}



# Trans-Saharan West African Merchant offers services or at least a good deal (can spawn anywhere [GetGeographicalRegion('world_africa').GetName])
sus.0031 = {
	type = character_event
	title = sus.0031.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_sus_currently_trans_saharan_networking
				}
				desc = sus.0030.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = RICE_sus_currently_trans_saharan_networking }
				}
				desc = sus.0030.desc.intro_normal
			}			
		}
		desc = sus.0031.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = throne_room }
	
	
	left_portrait = {
		character = scope:RICE_trans_saharan_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = world_africa
		}
		NOT = { has_character_flag = RICE_trans_saharan_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.7
			capital_province = {
				geographical_region = ghw_region_subsahelian_africa
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = RICE_trans_saharan_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				has_government = tribal_government
			}
		}
		modifier = {
			add = 1.1
			dynasty = {
				has_dynasty_perk = RICE_trans_saharan_trade_legacy_1
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_RICE_gold_dust_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = RICE_trans_saharan_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = RICE_trans_saharan_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = RICE_trans_saharan_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = RICE_trans_saharan_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = RICE_trans_saharan_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = RICE_trans_saharan_already_spawned_merchant
		


		if = {
			limit = {
				any_county_in_region = {
					region = RICE_west_africa_trade_region
					OR = {
						culture_has_west_african_heritage_pillar_trigger = yes
						culture_has_east_african_heritage_pillar_trigger = yes
						culture_has_central_african_heritage_pillar_trigger = yes
					}
				}
			}
			every_county_in_region = {
				region = RICE_west_africa_trade_region
				limit = {
					OR = {
						culture_has_west_african_heritage_pillar_trigger = yes
						culture_has_east_african_heritage_pillar_trigger = yes
						culture_has_central_african_heritage_pillar_trigger = yes
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
			}
			create_character = {
				location = root.location
				template = RICE_trans_saharan_merchant_template
				save_scope_as = RICE_trans_saharan_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				# Malinke
				# Soninke
				# Serer
				# Wolof
				# Hausa
				# Kanuri
				10 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:malinke
						faith = faith:west_african_pagan
					}				
				}
				10 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:malinke
						faith = faith:ashari
					}				
				}
				10 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:soninke
						faith = faith:west_african_bidu_pagan
					}				
				}
				10 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:soninke
						faith = faith:ashari
					}				
				}
				20 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:serer
						faith = faith:west_african_roog_pagan
					}				
				}
				20 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:wolof
						faith = faith:west_african_roog_pagan
					}				
				}
				15 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:hausa
						faith = faith:west_african_bori_pagan
					}				
				}
				5 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:hausa
						faith = faith:ashari
					}				
				}
				15 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:kanuri
						faith = faith:west_african_bori_pagan
					}				
				}
				5 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:kanuri
						faith = faith:ashari
					}				
				}
			}
		}



		hidden_effect = {
			scope:RICE_trans_saharan_merchant_spawn = {
				RICE_sus_determine_merchant_skill_effect = yes
			}
		}
	}

	# Okay
	option = {
		name = sus.0030.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:RICE_trans_saharan_merchant_spawn
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_west_african_merchants
			years = 10
		}
		random_realm_county = {
			if = {
				limit = { NOT = { culture = scope:RICE_trans_saharan_merchant_spawn.culture } }
				save_scope_as = county
				promote_culture_minority_effect = {
					CULTURE = scope:RICE_trans_saharan_merchant_spawn.culture
				}
			}
		}
		hidden_effect = {
			random = {
				chance = 50
				RICE_generate_small_family = { CHARACTER = scope:RICE_trans_saharan_merchant_spawn }
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = sus.0030.b
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_west_african_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = sus.0030.c
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = RICE_sus_currently_trans_saharan_networking
			}
			RICE_sus_clean_up_trans_saharan_merchant_effect = yes
		}
	}
}




# Trans-Saharan Berber Merchant offers services or at least a good deal (can spawn anywhere [GetGeographicalRegion('world_africa').GetName])
sus.0032 = {
	type = character_event
	title = sus.0032.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_sus_currently_trans_saharan_networking
				}
				desc = sus.0030.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = RICE_sus_currently_trans_saharan_networking }
				}
				desc = sus.0030.desc.intro_normal
			}			
		}
		desc = sus.0032.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = throne_room }
	
	
	left_portrait = {
		character = scope:RICE_trans_saharan_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = world_africa
		}
		NOT = { has_character_flag = RICE_trans_saharan_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.7
			capital_province = {
				geographical_region = ghw_region_subsahelian_africa
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = RICE_trans_saharan_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				has_government = tribal_government
			}
		}
		modifier = {
			add = 1.1
			dynasty = {
				has_dynasty_perk = RICE_trans_saharan_trade_legacy_1
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_RICE_gold_dust_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = RICE_trans_saharan_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = RICE_trans_saharan_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = RICE_trans_saharan_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = RICE_trans_saharan_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = RICE_trans_saharan_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = RICE_trans_saharan_already_spawned_merchant

		if = {
			limit = {
				any_county_in_region = {
					region = world_africa
					culture = {
						has_cultural_pillar = heritage_berber
					}
				}
			}
			every_county_in_region = {
				region = world_africa
				limit = {
					culture = {
						has_cultural_pillar = heritage_berber
					}
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
			}
			create_character = {
				location = root.location
				template = RICE_trans_saharan_merchant_template
				save_scope_as = RICE_trans_saharan_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				# Butr
				# Baranis
				15 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:butr
						faith = faith:ashari
					}				
				}
				5 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:butr
						faith = faith:ibadi
					}				
				}
				15 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:baranis
						faith = faith:ashari
					}				
				}
				5 = {
					trigger = {
						NOT = { has_global_variable = RICE_game_started_on_TFE_start_date }
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:baranis
						faith = faith:ibadi
					}				
				}
				10 = {
					trigger = {
						has_global_variable = RICE_game_started_on_TFE_start_date
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:garamantian
						faith = faith:amazigh_pagan
					}				
				}
				10 = {
					trigger = {
						has_global_variable = RICE_game_started_on_TFE_start_date
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:maurian
						faith = faith:amazigh_pagan
					}				
				}
				10 = {
					trigger = {
						has_global_variable = RICE_game_started_on_TFE_start_date
					}
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:gaetulian
						faith = faith:amazigh_pagan
					}				
				}
			}
		}


		hidden_effect = {
			scope:RICE_trans_saharan_merchant_spawn = {
				RICE_sus_determine_merchant_skill_effect = yes
			}
		}
	}

	# Okay
	option = {
		name = sus.0030.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:RICE_trans_saharan_merchant_spawn
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_berber_merchants
			years = 10
		}
		random_realm_county = {
			if = {
				limit = { NOT = { culture = scope:RICE_trans_saharan_merchant_spawn.culture } }
				save_scope_as = county
				promote_culture_minority_effect = {
					CULTURE = scope:RICE_trans_saharan_merchant_spawn.culture
				}
			}
		}
		hidden_effect = {
			random = {
				chance = 50
				RICE_generate_small_family = { CHARACTER = scope:RICE_trans_saharan_merchant_spawn }
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = sus.0030.b
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_berber_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = sus.0030.c
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = RICE_sus_currently_trans_saharan_networking
			}
			RICE_sus_clean_up_trans_saharan_merchant_effect = yes
		}
	}
	
}



# Trans-Saharan Jewish Merchant offers services or at least a good deal (can spawn anywhere [GetGeographicalRegion('world_africa').GetName])
sus.0033 = {
	type = character_event
	title = sus.0033.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_sus_currently_trans_saharan_networking
				}
				desc = sus.0030.desc.intro_networker
			}		
			triggered_desc = {
				trigger = {
					NOT = { has_character_modifier = RICE_sus_currently_trans_saharan_networking }
				}
				desc = sus.0030.desc.intro_normal
			}			
		}
		desc = sus.0033.desc
	}
	
	theme = stewardship_wealth_focus
	override_background = { reference = throne_room }
	
	
	left_portrait = {
		character = scope:RICE_trans_saharan_merchant_spawn
		animation = steward
	}
	
	trigger = {
		capital_province = {
			geographical_region = world_africa
		}
		NOT = { has_character_flag = RICE_trans_saharan_guaranteed_spawn }
	}
	
	weight_multiplier = {
		base = 1
		modifier = {
			add = -0.7
			capital_province = {
				geographical_region = ghw_region_subsahelian_africa
			}			
		}
		modifier = {
			add = -0.4
			has_character_flag = RICE_trans_saharan_already_spawned_merchant
		}
		modifier = {
			add = -0.1
			AND = {
				is_ruler = yes
				has_government = tribal_government
			}
		}
		modifier = {
			add = 1.1
			dynasty = {
				has_dynasty_perk = RICE_trans_saharan_trade_legacy_1
			}
		}
		modifier = {
			add = 1.1
			culture = { has_cultural_tradition = tradition_RICE_gold_dust_traders }
		}
		modifier = {
			add = 0.75
			has_character_flag = RICE_trans_saharan_networking_boost_tiny
		}
		modifier = {
			add = 1
			has_character_flag = RICE_trans_saharan_networking_boost_small
		}
		modifier = {
			add = 1.33
			has_character_flag = RICE_trans_saharan_networking_boost_medium
		}
		modifier = {
			add = 1.66
			has_character_flag = RICE_trans_saharan_networking_boost_large
		}
		modifier = {
			add = 2
			has_character_flag = RICE_trans_saharan_networking_boost_huge
		}
	}

	immediate = {
		capital_province = { save_scope_as = capital_province } #For loc.
		add_character_flag = RICE_trans_saharan_already_spawned_merchant

		if = {
			limit = {
				any_county_in_region = {
					region = custom_roman_full_borders
					religion = religion:judaism_religion
					culture = { has_cultural_pillar = heritage_israelite }
				}
			}
			every_county_in_region = {
				region = custom_roman_full_borders
				limit = {
					religion = religion:judaism_religion
					culture = { has_cultural_pillar = heritage_israelite }
				}
				add_to_list = merchant_counties
			}
			random_in_list = {
				list = merchant_counties
				save_scope_as = home_county
			}
			create_character = {
				location = root.location
				template = RICE_trans_saharan_merchant_template
				save_scope_as = RICE_trans_saharan_merchant_spawn
				culture = scope:home_county.culture
				faith = scope:home_county.faith
			}
		}

		# Backup in case no such county can be found
		else = {
			random_list = {
				# Ashkenazi
				# Sephardi
				# Mustaarabi
				15 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:ashkenazi
						faith = faith:rabbinism
					}				
				}
				5 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:ashkenazi
						faith = faith:karaism
					}				
				}
				15 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:sephardi
						faith = faith:rabbinism
					}				
				}
				5 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:sephardi
						faith = faith:karaism
					}				
				}
				45 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:bavlim
						faith = faith:rabbinism
					}				
				}
				15 = {
					create_character = {
						location = root.location
						template = RICE_trans_saharan_merchant_template
						save_scope_as = RICE_trans_saharan_merchant_spawn
						culture = culture:bavlim
						faith = faith:karaism
					}				
				}
			}
		}


		hidden_effect = {
			scope:RICE_trans_saharan_merchant_spawn = {
				RICE_sus_determine_merchant_skill_effect = yes
			}
		}
	}

	# Okay
	option = {
		name = sus.0030.a
		add_prestige = -150
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_courtier = scope:RICE_trans_saharan_merchant_spawn
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_jewish_merchants
			years = 10
		}
		random_realm_county = {
			if = {
				limit = { NOT = { culture = scope:RICE_trans_saharan_merchant_spawn.culture } }
				save_scope_as = county
				promote_culture_minority_effect = {
					CULTURE = scope:RICE_trans_saharan_merchant_spawn.culture
				}
			}
		}
		hidden_effect = {
			random = {
				chance = 50
				RICE_generate_small_family = { CHARACTER = scope:RICE_trans_saharan_merchant_spawn }
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Don't stay, but create a trade deal
	option = {
		name = sus.0030.b
		pay_short_term_gold = {
			target = scope:RICE_trans_saharan_merchant_spawn
			gold = medium_gold_value
		}
		add_character_modifier = {
			modifier = RICE_sus_trade_deal_jewish_merchants
			years = 10
		}
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 40
			modifier = {
				add = 10
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = ambitious
			}
		}
	}

	# Not interested
	option = {
		name = sus.0030.c
		hidden_effect = {
			random = {
				chance = 75
				scope:RICE_trans_saharan_merchant_spawn = {
					death = {
						death_reason = death_disappearance
					}
				}
			}
		}
		ai_chance = {
			base = 25
		}
	}
	
	after = {
		if = {
			limit = {
				has_character_modifier = RICE_sus_currently_trans_saharan_networking
			}
			RICE_sus_clean_up_trans_saharan_merchant_effect = yes
		}
	}
}

# Just here to shush errors.
# Sinicization name event
tarim_basin.0010 = {
	type = character_event
	title = tarim_basin.0010.t
	desc = {
		desc = tarim_basin.0010.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					game_start_date >= 755.1.1
					game_start_date <= 950.1.1
					current_date < 1000.1.1
				}
				desc = tarim_basin.0010.desc.867
			}
		}
	}
	theme = family
	right_portrait = root

	immediate = {
		RICE_tarim_basin_sinicize_effect = yes
	}
	
	#NAMING WIDGET
	widgets = {
		widget = {
			gui = "event_window_widget_RICE_sinicize_name"
			container = "dynamic_birth_name"
			controller = name_character
			setup_scope = {
				root = { save_scope_as = name_character_target }
			}
		}
	}

	#Go ahead
	option = {
		name = tarim_basin.0010.a
	}

	#On second thought...
	option = {
		name = tarim_basin.0010.b
		is_cancel_option = yes
	}

}


# Silk Road community selected: Now does silk road minority spawning
tarim_basin.0020 = {
	type = character_event
	title = tarim_basin.0020.t
	desc = {
		desc = tarim_basin.0020.desc.intro
		first_valid = {
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:east_asian
				}
				desc = tarim_basin.0020.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:steppe
				}
				desc = tarim_basin.0020.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:middle_eastern
				}
				desc = tarim_basin.0020.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:himalayan
				}
				desc = tarim_basin.0020.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:indian
				}
				desc = tarim_basin.0020.desc.indian
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:east_african
				}
				desc = tarim_basin.0020.desc.east_african
			}	
			triggered_desc = {
				trigger = {
					var:RICE_silk_road_community_type = flag:southeast_asian
				}
				desc = tarim_basin.0020.desc.southeast_asian
			}	
		}
	}
	theme = realm
	
	right_portrait = {
		character = root
		animation = war_defender
	}
	
	option = {
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:east_asian }
			text = tarim_basin.0020.option.east_asian
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:steppe }
			text = tarim_basin.0020.option.steppe
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:middle_eastern }
			text = tarim_basin.0020.option.middle_eastern
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:himalayan }
			text = tarim_basin.0020.option.himalayan
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:indian }
			text = tarim_basin.0020.option.indian
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:east_african }
			text = tarim_basin.0020.option.east_african
		}
		name = {
			trigger = { var:RICE_silk_road_community_type = flag:southeast_asian }
			text = tarim_basin.0020.option.southeast_asian
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:east_asian
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_asian_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_asian_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.east_asian
			do_silk_road_migration_effect = { REGION = world_china }
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:steppe
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_steppe_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_steppe_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.steppe
			do_silk_road_migration_effect = { REGION = RICE_silk_road_steppe }
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:middle_eastern
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_middle_eastern_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_middle_eastern_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.middle_eastern
			do_silk_road_migration_effect = { REGION = RICE_silk_road_middle_east }
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:himalayan
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_himalayan_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_himalayan_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.himalayan
			do_silk_road_migration_effect = { REGION = RICE_silk_road_himalayas }
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:indian
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_indian_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_indian_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.indian
			do_silk_road_migration_effect = { REGION = RICE_silk_road_india }
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:east_african
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_african_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_east_african_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.east_african
			RICE_east_african_migration_effect = yes
		}
		if = {
			limit = {
				var:RICE_silk_road_community_type = flag:southeast_asian
			}
			if = {
				limit = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = RICE_tarim_basin_silk_road_legacy_3
					}
				}
				add_character_modifier = {
					modifier = RICE_tarim_basin_southeast_asian_contacts
					years = 20
				}
			}
			else = {
				add_character_modifier = {
					modifier = RICE_tarim_basin_southeast_asian_contacts
					years = 10
				}
			}
			custom_tooltip = tarim_basin.0020.tooltip.southeast_asian
			do_silk_road_migration_effect = { REGION = RICE_silk_road_SEA }
		}
	}

	after = {
		if = {
			limit = { has_variable = RICE_silk_road_community_type }
			remove_variable = RICE_silk_road_community_type
		}
	}

}

# Gift of a courtier
tarim_basin.0029 = {
	type = character_event
	title = tarim_basin.0029.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_asian_contacts
				}
				desc = tarim_basin.0029.desc.east_asian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_steppe_contacts
				}
				desc = tarim_basin.0029.desc.steppe
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
				}
				desc = tarim_basin.0029.desc.middle_eastern
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_himalayan_contacts
				}
				desc = tarim_basin.0029.desc.himalayan
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_indian_contacts
				}
				desc = tarim_basin.0029.desc.indian
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_east_african_contacts
				}
				desc = tarim_basin.0029.desc.east_african
			}	
			triggered_desc = {
				trigger = {
					has_character_modifier = RICE_tarim_basin_southeast_asian_contacts
				}
				desc = tarim_basin.0029.desc.southeast_asian
			}
		}
	}
	theme = vassal
	
	left_portrait = root
	right_portrait = {
		character = scope:local
		animation = throne_room_bow_2
	}

	immediate = {
		if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_east_asian_contacts
			}
			# Culture selection
			random_list = {
				# Random culture from the map
				50 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_chinese }
								culture = { has_cultural_pillar = heritage_vietic }
								culture = { has_cultural_pillar = heritage_korean }
								culture = { has_cultural_pillar = heritage_yamato }
								culture = culture:khitan
								culture = {
									any_parent_culture_or_above = {
										this = culture:khitan
									}
								}
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_chinese }
								culture = { has_cultural_pillar = heritage_vietic }
								culture = { has_cultural_pillar = heritage_korean }
								culture = { has_cultural_pillar = heritage_yamato }
								culture = culture:khitan
								culture = {
									any_parent_culture_or_above = {
										this = culture:khitan
									}
								}
							}
						}
						# Biased towards being in the East Asian regions
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = RICE_east_asia_region
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
				10 = {
					culture:han = {
						save_scope_as = county_culture
					}
					random_list = {
						10 = {
							trigger = {
								roa_is_active = yes
							}
							faith:zenzong = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								roa_is_active = yes
							}
							faith:lixue = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								roa_is_active = yes
							}
							faith:shendao = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:mahayana = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:zhengyi = {
								save_scope_as = county_faith
							}
						}
					}
				}
				10 = {
					culture:kinh = {
						save_scope_as = county_culture
					}
					if = {
						limit = {
							roa_is_active = yes
						}
						faith:phat_giao = {
							save_scope_as = county_faith
						}
					}
					# else = {
						faith:mahayana = {
							save_scope_as = county_faith
						}
					# }
				}
				10 = {
					culture:samhan = {
						save_scope_as = county_culture
					}
					random_list = {
						10 = {
							faith:mahayana = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:muism = {
								save_scope_as = county_faith
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_steppe_contacts
			}
			# Culture selection
			random_list = {
				# Random culture from the map
				50 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_mongolic }
								culture = { has_cultural_pillar = heritage_turkic }
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_on_oq }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_tungusic }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_tatar }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_kipchak }
								}
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_mongolic }
								culture = { has_cultural_pillar = heritage_turkic }
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_on_oq }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_tungusic }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_tatar }
								}
								AND = {
									roa_is_active = yes
									culture = { has_cultural_pillar = heritage_kipchak }
								}
							}
						}
						# Biased towards being in the steppe regions
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = world_steppe
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
				# Random
				10 = {
					random_culture_global = {
						limit = {
							OR = {
								has_cultural_pillar = heritage_mongolic
								has_cultural_pillar = heritage_turkic
								AND = {
									roa_is_active = yes
									has_cultural_pillar = heritage_on_oq
								}
								AND = {
									roa_is_active = yes
									has_cultural_pillar = heritage_tungusic
								}
								AND = {
									roa_is_active = yes
									has_cultural_pillar = heritage_tatar
								}
								AND = {
									roa_is_active = yes
									has_cultural_pillar = heritage_kipchak
								}
							}
						}		
						save_scope_as = county_culture
					}
					random_list = {
						10 = {
							religion:tengri_pagan = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:islam_spawned
								}
							}
							religion:islam_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							religion:buddhism_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:council_chalc
								}
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:manichean = {
								save_scope_as = county_faith
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_middle_eastern_contacts
			}
			# Culture selection
			random_list = {
				# Random culture from the map
				50 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_arabic }
								culture = { has_cultural_pillar = heritage_iranian }
								culture = { has_cultural_pillar = heritage_israelite }
								culture = { has_cultural_pillar = heritage_berber }
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_levantine }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_south_semitic }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_kemetic }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_semitic }
								}
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_arabic }
								culture = { has_cultural_pillar = heritage_iranian }
								culture = { has_cultural_pillar = heritage_israelite }
								culture = { has_cultural_pillar = heritage_berber }
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_levantine }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_south_semitic }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_kemetic }
								}
								AND = {
									exists = culture:soissons
									culture = { has_cultural_pillar = heritage_semitic }
								}
							}
						}
						# Biased towards being in the steppe regions
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = RICE_west_asia_region
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
				# Random - Jewish
				40 = {
					random_list = {
						# Bavlim/Middle Eastern Jews
						10 = {
							culture:bavlim = {
								save_scope_as = county_culture
							}
							random_list = {
								60 = {
									faith:rabbinism = {
										save_scope_as = county_faith
									}
								}
								40 = {
									faith:karaism = {
										save_scope_as = county_faith
									}
								}
							}
						}
						# Radhanites
						10 = {
							culture:radhanite = {
								save_scope_as = county_culture
							}
							random_list = {
								70 = {
									faith:rabbinism = {
										save_scope_as = county_faith
									}
								}
								30 = {
									faith:karaism = {
										save_scope_as = county_faith
									}
								}
							}
						}
						# Indian Jews
						10 = {
							culture:kochinim = {
								save_scope_as = county_culture
							}
							faith:malabarism = {
								save_scope_as = county_faith
							}
						}
						# Persian Jews
						10 = {
							culture:parsim = {
								save_scope_as = county_culture
							}
							random_list = {
								70 = {
									faith:rabbinism = {
										save_scope_as = county_faith
									}
								}
								30 = {
									faith:karaism = {
										save_scope_as = county_faith
									}
								}
							}
						}
						# Yemeni Jews
						10 = {
							culture:teimani = {
								save_scope_as = county_culture
							}
							random_list = {
								70 = {
									faith:rabbinism = {
										save_scope_as = county_faith
									}
								}
								30 = {
									faith:karaism = {
										save_scope_as = county_faith
									}
								}
							}
						}
						# Ethiopian Jews - covered by the East African community
						# 10 = {
						# 	culture:ethiopian = {
						# 		save_scope_as = county_culture
						# 	}
						# 	faith:haymanot = {
						# 		save_scope_as = county_faith
						# 	}
						# }
					}
				}
				# Arabic
				10 = {
					random_culture_global = {
						limit = {
							has_cultural_pillar = heritage_arabic
						}		
						save_scope_as = county_culture
					}
					random_list = {
						40 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:islam_spawned
								}
							}
							religion:islam_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:council_chalc
								}
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								exists = culture:soissons
								NOT = { exists = global_var:islam_spawned }
							}
							faith:arabic_pagan = {
								save_scope_as = county_faith
							}
						}
						5 = {
							faith:manichean = {
								save_scope_as = county_faith
							}
						}
					}
				}
				# Iranian
				10 = {
					random_culture_global = {
						limit = {
							has_cultural_pillar = heritage_iranian
						}		
						save_scope_as = county_culture
					}
					random_list = {
						50 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:islam_spawned
								}
							}
							religion:islam_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							religion:zoroastrianism_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:council_chalc
								}
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								exists = culture:soissons
								NOT = { exists = global_var:council_chalc }
							}
							faith:chalcedonian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:manichean = {
								save_scope_as = county_faith
							}
						}
					}
				}
				# South Semitic (for TFE)
				10 = {
					trigger = {
						exists = culture:soissons
					}
					random_culture_global = {
						limit = {
							has_cultural_pillar = heritage_south_semitic
						}		
						save_scope_as = county_culture
					}
					random_list = {
						50 = {
							trigger = {
								exists = global_var:islam_spawned
							}
							religion:islam_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						10 = {
							trigger = {
								NOT = { exists = global_var:council_chalc }
							}
							faith:chalcedonian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								exists = global_var:council_chalc
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							trigger = {
								NOT = { exists = global_var:islam_spawned }
							}
							faith:south_arabian_pagan = {
								save_scope_as = county_faith
							}
						}
					}
				}
				# Levantine (for TFE)
				10 = {
					trigger = {
						exists = culture:soissons
					}
					random_culture_global = {
						limit = {
							has_cultural_pillar = heritage_semitic
						}		
						save_scope_as = county_culture
					}
					random_list = {
						30 = {
							trigger = {
								NOT = { exists = global_var:council_chalc }
							}
							faith:chalcedonian = {
								save_scope_as = county_faith
							}
						}
						30 = {
							trigger = {
								exists = global_var:council_chalc
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						10 = {
							faith:manichean = {
								save_scope_as = county_faith
							}
						}
						5 = {
							faith:mandeaism = {
								save_scope_as = county_faith
							}
						}
						5 = {
							faith:harranian_pagan = {
								save_scope_as = county_faith
							}
						}
					}
				}
				# Assyrians (covered by Levantine above for TFE)
				10 = {
					trigger = {
						NOT = { exists = culture:soissons }
					}
					culture:assyrian = {
						save_scope_as = county_culture
					}
					random_list = {
						80 = {
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						5 = {
							faith:manichean = {
								save_scope_as = county_faith
							}
						}
						5 = {
							faith:mandeaism = {
								save_scope_as = county_faith
							}
						}
						5 = {
							trigger = {
								NOT = {
									is_target_in_global_variable_list = {
										name = unavailable_unique_decisions
										target = flag:RICE_harran_neoplatonic_academy_declined
									}
								}
							}
							faith:harranian_pagan = {
								save_scope_as = county_faith
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_himalayan_contacts
			}
			random_list = {
				# Random culture from the map
				80 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_tibetan }
								culture = { has_cultural_pillar = heritage_qiangic }
								culture = { has_cultural_pillar = heritage_loloish }
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_tibetan }
								culture = { has_cultural_pillar = heritage_qiangic }
								culture = { has_cultural_pillar = heritage_loloish }
							}
						}
						# Biased towards being in the Himalayan region
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = world_tibet
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
				# Tibetan
				30 = {
					random_culture_global = {
						limit = {
							has_cultural_pillar = heritage_tibetan
						}		
						save_scope_as = county_culture
					}
					random_list = {
						10 = {
							faith:lamaism = {
								save_scope_as = county_faith
							}
						}
						10 = {
							religion:bon_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
					}
				}
				# Qiangic
				10 = {
					random_list = {
						10 = {							
							culture:tangut = {
								save_scope_as = county_culture
							}
							faith:melieism = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:tangut = {
								save_scope_as = county_culture
							}
							faith:vajrayana = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:tangut = {
								save_scope_as = county_culture
							}
							faith:mahayana = {
								save_scope_as = county_faith
							}
						}
						30 = {
							culture:qiang = {
								save_scope_as = county_culture
							}
							faith:rrmeaism = {
								save_scope_as = county_faith
							}
						}
					}
				}
				# Loloish
				# 10 = {
				# 	random_list = {
				# 		10 = {							
				# 			culture:tangut = {
				# 				save_scope_as = county_culture
				# 			}
				# 			faith:melieism = {
				# 				save_scope_as = county_faith
				# 			}
				# 		}
				# 	}
				# }
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_indian_contacts
			}
			random_list = {
				# Random culture from the map
				50 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_dravidian }
								culture = { has_cultural_pillar = heritage_indo_aryan }
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_dravidian }
								culture = { has_cultural_pillar = heritage_indo_aryan }
							}
						}
						# Biased towards being in the Himalayan region
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = world_india
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}	
				# Random
				10 = {
					random_culture_global = {
						limit = {
							OR = {
								has_cultural_pillar = heritage_indo_aryan
								has_cultural_pillar = heritage_dravidian
							}
						}		
						save_scope_as = county_culture
					}
					random_list = {
						15 = {
							religion:buddhism_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						15 = {
							religion:hinduism_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						15 = {
							religion:jainism_religion = {
								random_faith = {
									save_scope_as = county_faith
								}
							}
						}
						5 = {
							trigger = {
								OR = {
									NOT = { exists = culture:soissons }
									exists = global_var:council_chalc
								}
							}
							faith:nestorian = {
								save_scope_as = county_faith
							}
						}
						5 = {
							trigger = {
								exists = culture:soissons
								NOT = { exists = global_var:council_chalc }
							}
							faith:chalcedonian = {
								save_scope_as = county_faith
							}
						}
					}
				}							
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_east_african_contacts
			}
			random_list = {
				# Random culture from the map
				50 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_east_african }
								culture = { has_cultural_pillar = heritage_somalian }
								culture = { has_cultural_pillar = heritage_east_bantu }
								culture = { has_cultural_pillar = heritage_south_bantu }
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_east_african }
								culture = { has_cultural_pillar = heritage_somalian }
								culture = { has_cultural_pillar = heritage_east_bantu }
								culture = { has_cultural_pillar = heritage_south_bantu }
							}
						}
						# Biased towards being in the Himalayan region
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = world_africa_east
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
				# East African Christian
				10 = {
					random_list = {
						10 = {
							culture:ethiopian = {
								save_scope_as = county_culture
							}
						}
						10 = {
							culture:nubian = {
								save_scope_as = county_culture
							}
						}
					}
					if = {
						limit = {
							exists = culture:soissons
							NOT = { exists = global_var:council_chalc }
						}
						faith:chalcedonian = {
							save_scope_as = county_faith
						}
					}
					else = {
						faith:coptic = {
							save_scope_as = county_faith
						}
					}
				}	
				# East African Muslim
				10 = {
					trigger = {
						OR = {
							NOT = { exists = culture:soissons }
							exists = global_var:islam_spawned
						}
					}
					random_list = {
						10 = {
							culture:somali = {
								save_scope_as = county_culture
							}
						}
						5 = {
							culture:afar = {
								save_scope_as = county_culture
							}
						}
						5 = {
							culture:beja = {
								save_scope_as = county_culture
							}
						}
						20 = {
							culture:swahili = {
								save_scope_as = county_culture
							}
						}
					}
					if = {
						limit = {
							exists = culture:soissons
							exists = global_var:islam_spawned
							faith:united_islam = {
								has_doctrine = unavailable_doctrine
							}
						}
						faith:united_islam = {
							save_scope_as = county_faith
						}
					}
					else = {
						faith:ashari = {
							save_scope_as = county_faith
						}
					}
				}	
				# East African Pagan
				10 = {
					random_list = {
						20 = {
							culture:somali = {
								save_scope_as = county_culture
							}
							faith:waaqism_pagan = {
								save_scope_as = county_faith
							}
						}
						5 = {
							culture:afar = {
								save_scope_as = county_culture
							}
							faith:waaqism_pagan = {
								save_scope_as = county_faith
							}
						}
						5 = {
							culture:beja = {
								save_scope_as = county_culture
							}
							faith:kushitism_pagan = {
								save_scope_as = county_faith
							}
						}
						5 = {
							culture:daju = {
								save_scope_as = county_culture
							}
							faith:kushitism_pagan = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:welayta = {
								save_scope_as = county_culture
							}
							faith:welayta_pagan = {
								save_scope_as = county_faith
							}
						}
					}
				}	
				# Ethiopian Jews - covered by the East African community
				10 = {
					culture:ethiopian = {
						save_scope_as = county_culture
					}
					faith:haymanot = {
						save_scope_as = county_faith
					}
				}	
				# Off-map Bantu Africans
				40 = {
					random_list = {
						15 = {
							culture:makonde = {
								save_scope_as = county_culture
							}
							faith:makonde_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:malagasy = {
								save_scope_as = county_culture
							}
							faith:malagasy_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:mijikenda = {
								save_scope_as = county_culture
							}
							faith:mijikenda_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:pokomo = {
								save_scope_as = county_culture
							}
							faith:mijikenda_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:seuta = {
								save_scope_as = county_culture
							}
							faith:mijikenda_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:sabaki = {
								save_scope_as = county_culture
							}
							faith:mijikenda_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:ruvu = {
								save_scope_as = county_culture
							}
							faith:mijikenda_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:shona = {
								save_scope_as = county_culture
							}
							faith:shona_pagan = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:makua = {
								save_scope_as = county_culture
							}
							faith:makua_pagan = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:tsonga = {
								save_scope_as = county_culture
							}
							faith:tsonga_pagan = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:nguni = {
								save_scope_as = county_culture
							}
							faith:nguni_pagan = {
								save_scope_as = county_faith
							}
						}
						10 = {
							culture:sotho_tswana = {
								save_scope_as = county_culture
							}
							faith:sotho_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:dahalo = {
								save_scope_as = county_culture
							}
							faith:waaqism_pagan = {
								save_scope_as = county_faith
							}
						}
						15 = {
							culture:aweer = {
								save_scope_as = county_culture
							}
							faith:waaqism_pagan = {
								save_scope_as = county_faith
							}
						}
					}					
				}			
			}
		}
		else_if = {
			limit = {
				has_character_modifier = RICE_tarim_basin_southeast_asian_contacts
			}
			random_list = {
				# Random culture from the map
				10 = {
					trigger = {
						any_county = {
							OR = {
								culture = { has_cultural_pillar = heritage_burman }
								culture = { has_cultural_pillar = heritage_tai }
								culture = { has_cultural_pillar = heritage_malayic }
								culture = { has_cultural_pillar = heritage_khmer }
								culture = { has_cultural_pillar = heritage_chamic }
								culture = { has_cultural_pillar = heritage_sulawesi }
								culture = { has_cultural_pillar = heritage_filipino }
								culture = { has_cultural_pillar = heritage_mon }
								culture = { has_cultural_pillar = heritage_katuic }
								culture = { has_cultural_pillar = heritage_dayak }
							}
						}
					}
					random_county = {
						limit = {
							OR = {
								culture = { has_cultural_pillar = heritage_burman }
								culture = { has_cultural_pillar = heritage_tai }
								culture = { has_cultural_pillar = heritage_malayic }
								culture = { has_cultural_pillar = heritage_khmer }
								culture = { has_cultural_pillar = heritage_chamic }
								culture = { has_cultural_pillar = heritage_sulawesi }
								culture = { has_cultural_pillar = heritage_filipino }
								culture = { has_cultural_pillar = heritage_mon }
								culture = { has_cultural_pillar = heritage_katuic }
								culture = { has_cultural_pillar = heritage_dayak }
							}
						}
						# Biased towards being in the mainland SEA region
						weight = {
							base = 10
							modifier = {
								add = 10
								title_province = {
									geographical_region = world_mainland_southeast_asia
								}
							}
						}
						save_scope_as = county
					}
					scope:county.faith = {
						save_scope_as = county_faith
					}
					scope:county.culture = {
						save_scope_as = county_culture
					}
				}
			}
		}

		create_character = {
			location = root.location
			gender_female_chance = root_faith_dominant_gender_adjusted_female_chance
			faith = scope:county_faith
			culture = scope:county_culture
			random_traits = yes
			save_scope_as = local
		}
	}



	option = { # Ok
		name = tarim_basin.0029.a
		pay_short_term_gold = {
			target = scope:local
			gold = minor_gold_value
		}
		add_courtier = scope:local
	}

	option = { # Ok
		name = tarim_basin.0029.b
		hidden_effect = {
			scope:local = {
				death = {
					death_reason = death_vanished
				}
			}
		}	
	}
}



### Override Siberian spawning (Evenk and Nivkh courtiers aren't notable in Manchuria because that's where they live)
# Siberian Courtier Arrives
siberia.0001 = {
	type = character_event
	title = siberia.0001.t
	desc = {
		desc = siberia.0001.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_siberia_evenk_maker
				}
				desc = siberia.0001.desc.evenk
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_siberia_nivkh_maker
				}
				desc = siberia.0001.desc.nivkh
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_siberia_yakut_maker
				}
				desc = siberia.0001.desc.yakut
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_siberia_yeniseian_maker
				}
				desc = siberia.0001.desc.yeniseian
			}
			triggered_desc = {
				trigger = {
					has_character_flag = RICE_siberia_yukaghir_maker
				}
				desc = siberia.0001.desc.yukaghir
			}
		}
	}
	
	theme = RICE_theme_pine_landscape
	
	left_portrait = {
		character = root
		animation = idle
	}
	right_portrait = {
		character = scope:scope_RICE_siberian
		animation = personality_honorable
	}
	
	trigger = {	
		any_directly_owned_province = {
			RICE_is_in_siberian_region_courtier_spawn_trigger = yes
		}
		NOT = {
			any_courtier = {
				RICE_siberia_siberian_wanderer_trigger = yes
			}		
		}
		#OR = {
		#	is_ai = no
		#	short_term_gold >= minor_gold_value
		#}
	}

	immediate = {
		random_list = {
			10 = {
				trigger = {
					# Don't spawn Evenk and Nivkh event courtiers in Manchuria, they aren't unusual here
					any_realm_county = {
						count <= 0
						geographical_region = world_manchuria
					}
				}
				add_character_flag = RICE_siberia_evenk_maker
				create_character = {
					location = root.location
					template = siberian_wanderer_character_template
					save_scope_as = scope_RICE_siberian
					culture = culture:evenk
					faith = faith:bugaism
				}			
			}
			10 = {
				trigger = {
					# Don't spawn Evenk and Nivkh event courtiers in Manchuria, they aren't unusual here
					any_realm_county = {
						count <= 0
						geographical_region = world_manchuria
					}
				}
				add_character_flag = RICE_siberia_nivkh_maker
				create_character = {
					location = root.location
					template = siberian_wanderer_character_template
					save_scope_as = scope_RICE_siberian
					culture = culture:nivkh
					faith = faith:yzng
				}			
			}
			10 = {
				add_character_flag = RICE_siberia_yakut_maker
				create_character = {
					location = root.location
					template = siberian_wanderer_character_template
					save_scope_as = scope_RICE_siberian
					culture = culture:yakut
					faith = faith:tengri_pagan
				}			
			}
			10 = {
				add_character_flag = RICE_siberia_yeniseian_maker
				create_character = {
					location = root.location
					template = siberian_wanderer_character_template
					save_scope_as = scope_RICE_siberian
					culture = culture:yeniseian
					faith = faith:siberian_pagan
				}			
			}
			10 = {
				add_character_flag = RICE_siberia_yukaghir_maker
				create_character = {
					location = root.location
					template = siberian_wanderer_character_template
					save_scope_as = scope_RICE_siberian
					culture = culture:yukaghir
					faith = faith:siberian_pagan
				}			
			}
		}
		hidden_effect = {
			if = {
				limit = {
					scope:scope_RICE_siberian = {
						culture = culture:evenk
					}
				}
				scope:scope_RICE_siberian = {
					add_character_modifier = {
						modifier = RICE_siberia_evenk_wanderer
					}
				}
			}
			if = {
				limit = {
					scope:scope_RICE_siberian = {
						culture = culture:nivkh
					}
				}
				scope:scope_RICE_siberian = {
					add_character_modifier = {
						modifier = RICE_siberia_nivkh_wanderer
					}
				}
			}
			if = {
				limit = {
					scope:scope_RICE_siberian = {
						culture = culture:yakut
					}
				}
				scope:scope_RICE_siberian = {
					add_character_modifier = {
						modifier = RICE_siberia_yakut_wanderer
					}
				}
			}
			if = {
				limit = {
					scope:scope_RICE_siberian = {
						culture = culture:yeniseian
					}
				}
				scope:scope_RICE_siberian = {
					add_character_modifier = {
						modifier = RICE_siberia_yeniseian_wanderer
					}
				}
			}
			if = {
				limit = {
					scope:scope_RICE_siberian = {
						culture = culture:yukaghir
					}
				}
				scope:scope_RICE_siberian = {
					add_character_modifier = {
						modifier = RICE_siberia_yukaghir_wanderer
					}
				}
			}
		}
	}

	# Hire them
	option = {
		name = siberia.0001.a
		pay_short_term_gold = {
			target = scope:scope_RICE_siberian
			gold = minor_gold_value
		}
		add_courtier = scope:scope_RICE_siberian
		custom_tooltip = siberia.0001.courtier_effect.1
		#custom_tooltip = siberia.0001.courtier_effect.2 - reindeer herd, no?
		# add_character_flag = {
		# 	flag = RICE_siberia_courtier_skill_delay # Make it so you won't get the skill boosts right away
		# 	months = 16
		# }
	}

	# Don't hire them
	option = {
		name = siberia.0001.b
		hidden_effect = {
			scope:scope_RICE_siberian = {
				death = {
					death_reason = death_disappearance
				}
			}
		}
	}
	
	after = {
		remove_character_flag = RICE_siberia_evenk_maker
		remove_character_flag = RICE_siberia_nivkh_maker
		remove_character_flag = RICE_siberia_yakut_maker
		remove_character_flag = RICE_siberia_yeniseian_maker
		remove_character_flag = RICE_siberia_yukaghir_maker
	}
	
}

## Limit Burusho feud to counties with a Burusho population
# Feud between two Burusho clans
pamir.0216 = {
	type = character_event
	title = pamir.0216.t
	desc = pamir.0216.desc
	theme = martial_strategy_focus	
	override_background = { reference = RICE_background_pamir_valley }
	
	left_portrait = {
		character = root
		animation = boredom
	}
	
	trigger = {
		RICE_pamir_in_pamir_region_trigger = yes
		any_county_in_region = {
			region = RICE_pamir_region
			county_has_culture_or_minority_trigger = { CULTURE = culture:burusho }
		}
	}
	
	immediate = {
		random_list = {
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_gilgit
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_gilgit = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_yasin
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_yasin = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_golaghmuli
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_golaghmuli = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_chitral
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_chitral = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_skardu
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_skardu = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_shigar
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_shigar = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_astore
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_astore = {
					save_scope_as = burusho_county
				}
			}
			10 = {
				modifier = {
					add = -10
					NAND = {
						has_title = title:c_allai
						title:c_gilgit = { county_has_culture_or_minority_trigger = { CULTURE = culture:burusho } }
					}
				}
				title:c_allai = {
					save_scope_as = burusho_county
				}
			}
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 0.2
			has_trait = lazy
		}
		modifier = {
			add = -0.2
			has_trait = diligent
		}
		modifier = {
			add = 0.2
			has_trait = arbitrary
		}
		modifier = {
			add = -0.2
			has_trait = just
		}
		modifier = {
			add = 0.2
			has_trait = callous
		}
		modifier = {
			add = -0.2
			has_trait = compassionate
		}
	}

	option = { # Can't we do something?
		name = pamir.0216.a
		random_list = {
			65 = {
				modifier = {
					add = 5
					has_trait = arbitrary
				}	
				modifier = {
					add = -5
					has_trait = just
				}	
				modifier = {
					add = 5
					has_trait = lazy
				}	
				modifier = {
					add = -5
					has_trait = diligent
				}	
				modifier = {
					add = 5
					has_trait = trusting
				}	
				modifier = {
					add = -5
					has_trait = sadistic
				}	
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = ROOT
					title = pamir.0216.toast.bad
					scope:burusho_county = {
						add_county_modifier = {
							modifier = RICE_pamir_burusho_feud
							years = 10
						}		
					}
				}			
			}
			35 = {	
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = ROOT
					title = pamir.0216.toast.good
					add_prestige = 100
				}			
			}
		}
	}

	option = { # Use diplomacy to resolve (best)
		name = pamir.0216.b
		trigger = {
			diplomacy >= decent_skill_rating
		}
		skill = diplomacy
		random_list = {
			20 = {
				modifier = {
					add = 3
					has_trait = arbitrary
				}	
				modifier = {
					add = -3
					has_trait = just
				}	
				modifier = {
					add = 3
					has_trait = lazy
				}	
				modifier = {
					add = -5
					has_trait = diligent
				}	
				modifier = {
					add = 3
					has_trait = shy
				}	
				modifier = {
					add = -3
					has_trait = gregarious
				}		
				modifier = {
					add = 3
					has_trait = deceitful
				}	
				modifier = {
					add = -3
					has_trait = honest
				}		
				modifier = {
					add = 3
					has_trait = wrathful
				}	
				modifier = {
					add = -3
					has_trait = calm
				}
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = ROOT
					title = pamir.0216.toast.bad
					scope:burusho_county = {
						add_county_modifier = {
							modifier = RICE_pamir_burusho_feud
							years = 10
						}		
					}
				}			
			}
			80 = {	
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = ROOT
					title = pamir.0216.toast.good
					add_prestige = 100
				}			
			}
		}
	}

	option = { # Use cunning and trickery (okay)
		name = pamir.0216.c
		trigger = {
			intrigue >= decent_skill_rating
		}
		skill = intrigue
		random_list = {
			30 = {
				modifier = {
					add = 3
					has_trait = arbitrary
				}	
				modifier = {
					add = -3
					has_trait = just
				}	
				modifier = {
					add = 3
					has_trait = lazy
				}	
				modifier = {
					add = -3
					has_trait = diligent
				}	
				modifier = {
					add = 3
					has_trait = honest
				}	
				modifier = {
					add = -3
					has_trait = deceitful
				}		
				modifier = {
					add = 3
					has_trait = impatient
				}	
				modifier = {
					add = -3
					has_trait = patient
				}		
				modifier = {
					add = 3
					has_trait = wrathful
				}	
				modifier = {
					add = -3
					has_trait = calm
				}
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = ROOT
					title = pamir.0216.toast.bad
					scope:burusho_county = {
						add_county_modifier = {
							modifier = RICE_pamir_burusho_feud
							years = 10
						}		
					}
				}			
			}
			70 = {	
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = ROOT
					title = pamir.0216.toast.good
					add_prestige = 100
				}			
			}
		}
	}

	option = { # Use military threats (worst)
		name = pamir.0216.d
		trigger = {
			martial >= decent_skill_rating
		}
		skill = martial
		random_list = {
			40 = {
				modifier = {
					add = 3
					has_trait = lazy
				}	
				modifier = {
					add = -3
					has_trait = diligent
				}	
				modifier = {
					add = 3
					has_trait = deceitful
				}	
				modifier = {
					add = -3
					has_trait = honest
				}		
				modifier = {
					add = 3
					has_trait = craven
				}	
				modifier = {
					add = -3
					has_trait = brave
				}		
				modifier = {
					add = 3
					has_trait = cynical
				}	
				modifier = {
					add = -3
					has_trait = zealous
				}		
				modifier = {
					add = 3
					has_trait = forgiving
				}	
				modifier = {
					add = -3
					has_trait = vengeful
				}
				send_interface_toast = {
					type = event_toast_effect_bad
					left_icon = ROOT
					title = pamir.0216.toast.bad
					scope:burusho_county = {
						add_county_modifier = {
							modifier = RICE_pamir_burusho_feud
							years = 10
						}		
					}
				}			
			}
			60 = {	
				send_interface_toast = {
					type = event_toast_effect_good
					left_icon = ROOT
					title = pamir.0216.toast.good
					add_prestige = 100
				}			
			}
		}
	}
}

# Land granted to Buddhist/Hindu/Jain monasteries/temples
sri_lanka.0010 = {
	type = character_event
	title = sri_lanka.0010.t
	desc = sri_lanka.0010.desc
	theme = faith
	override_background = { reference = ep2_holy_site_indian }
	
	right_portrait = root

	immediate = {


		hidden_effect = {
			every_held_title = {
				limit = {
					tier = tier_county
					any_county_province = {
						geographical_region = world_india
					}
				}
				random_list = {
					# Nothing happens
					90 = {
	
					}
					# Faith promotion
					10 = {
						add_to_list = RICE_land_grant_counties_conversion
					}
					# Small minority
					# 10 = {
					#	add_to_list = RICE_land_grant_counties_small_minority
					# }
					# # Large minority
					# 10 = {
					#	add_to_list = RICE_land_grant_counties_large_minority
					# }
				}				
			}				
		}	

		if = {
			limit = {
				var:RICE_india_land_grant_type = flag:buddhism
			}
			religion:buddhism_religion = {
				save_scope_as = religion
			}
			if = {
				limit = {					
					any_county_in_region = {
						region = world_india
						religion = religion:buddhism_religion
					}
				}
				random_county_in_region = {
					region = world_india
					limit = {
						religion = religion:buddhism_religion
					}
					save_scope_as = indian_county
				}
				scope:indian_county.faith = {
					save_scope_as = indian_faith
				}
			}
			else = {
				random_list = {
					10 = {
						faith:mahayana = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:theravada = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:vajrayana = {
							save_scope_as = indian_faith
						}
					}
				}
			}
			add_character_modifier = {
				modifier = RICE_india_land_grant_buddhist_character_modifier
				years = 10
			}
			if = {
				limit = {
					religion = religion:buddhism_religion
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_buddhist_county_same_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_buddhist_county_strong_same_modifier
						years = 10
					}				
				}
			}
			else = {
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_buddhist_county_different_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_buddhist_county_strong_different_modifier
						years = 10
					}				
				}
			}
			if = {
				limit = {
					religion = religion:buddhism_religion
				}
				add_prestige = RICE_india_grant_prestige_same_religion_value
				add_piety = RICE_india_grant_piety_same_religion_value
				stress_impact = {
					zealous = minor_stress_impact_loss
				}
			}
			else = {
				add_prestige = RICE_india_grant_prestige_different_religion_value
				add_piety = RICE_india_grant_piety_different_religion_value
				stress_impact = {
					zealous = minor_stress_impact_gain
				}
			}
			every_in_list = {
				list = RICE_land_grant_counties_conversion
				# limit = {
				# 	NOT = { religion = religion:buddhism_religion }
				# }
				# set_county_faith = scope:indian_faith
				save_scope_as = county
				promote_faith_minority_effect = { FAITH = scope:indian_faith }
			}
			# DO NOT REMOVE, THIS IS FOR COMPATIBILITY WITH RICE!!!
			RICE_sri_lanka_struggle_land_grant_buddhist_effect = yes
			RICE_TFE_struggle_land_grant_buddhist_effect = yes
		}

		else_if = {
			limit = {
				var:RICE_india_land_grant_type = flag:hinduism
			}
			religion:hinduism_religion = {
				save_scope_as = religion
			}
			if = {
				limit = {					
					any_county_in_region = {
						region = world_india
						religion = religion:hinduism_religion
					}
				}
				random_county_in_region = {
					region = world_india
					limit = {
						religion = religion:hinduism_religion
					}
					save_scope_as = indian_county
				}
				scope:indian_county.faith = {
					save_scope_as = indian_faith
				}
			}
			else = {
				random_list = {
					10 = {
						faith:vaishnavism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:advaitism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:shaivism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:srikula_shaktism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:kalikula_shaktism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:smartism = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:krishnaism = {
							save_scope_as = indian_faith
						}
					}
				}
			}
			add_character_modifier = {
				modifier = RICE_india_land_grant_hindu_character_modifier
				years = 10
			}
			if = {
				limit = {
					religion = religion:hinduism_religion
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_hindu_county_same_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_hindu_county_strong_same_modifier
						years = 10
					}				
				}
			}
			else = {
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_hindu_county_different_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_hindu_county_strong_different_modifier
						years = 10
					}				
				}
			}
			if = {
				limit = {
					religion = religion:hinduism_religion
				}
				add_prestige = RICE_india_grant_prestige_same_religion_value
				add_piety = RICE_india_grant_piety_same_religion_value
				stress_impact = {
					zealous = minor_stress_impact_loss
				}
			}
			else = {
				add_prestige = RICE_india_grant_prestige_different_religion_value
				add_piety = RICE_india_grant_piety_different_religion_value
				stress_impact = {
					zealous = minor_stress_impact_gain
				}
			}
			every_in_list = {
				list = RICE_land_grant_counties_conversion
				# limit = {
				# 	NOT = { religion = religion:hinduism_religion }
				# }
				# set_county_faith = scope:indian_faith
				save_scope_as = county
				promote_faith_minority_effect = { FAITH = scope:indian_faith }
			}
			# DO NOT REMOVE, THIS IS FOR COMPATIBILITY WITH RICE!!!
			RICE_sri_lanka_struggle_land_grant_non_buddhist_effect = yes
			RICE_TFE_struggle_land_grant_hindu_effect = yes
		}

		else_if = {
			limit = {
				var:RICE_india_land_grant_type = flag:jainism
			}
			religion:jainism_religion = {
				save_scope_as = religion
			}
			add_character_modifier = {
				modifier = RICE_india_land_grant_jain_character_modifier
				years = 10
			}
			if = {
				limit = {					
					any_county_in_region = {
						region = world_india
						religion = religion:jainism_religion
					}
				}
				random_county_in_region = {
					region = world_india
					limit = {
						religion = religion:jainism_religion
					}
					save_scope_as = indian_county
				}
				scope:indian_county.faith = {
					save_scope_as = indian_faith
				}
			}
			else = {
				random_list = {
					10 = {
						faith:yapaniya = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:svetambara = {
							save_scope_as = indian_faith
						}
					}
					10 = {
						faith:digambara = {
							save_scope_as = indian_faith
						}
					}
				}
			}
			if = {
				limit = {
					religion = religion:jainism_religion
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_jain_county_same_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_jain_county_strong_same_modifier
						years = 10
					}				
				}
			}
			else = {
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_jain_county_different_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_jain_county_strong_different_modifier
						years = 10
					}				
				}
			}
			if = {
				limit = {
					religion = religion:jainism_religion
				}
				add_prestige = RICE_india_grant_prestige_same_religion_value
				add_piety = RICE_india_grant_piety_same_religion_value
				stress_impact = {
					zealous = minor_stress_impact_loss
				}
			}
			else = {
				add_prestige = RICE_india_grant_prestige_different_religion_value
				add_piety = RICE_india_grant_piety_different_religion_value
				stress_impact = {
					zealous = minor_stress_impact_gain
				}
			}
			every_in_list = {
				list = RICE_land_grant_counties_conversion
				# limit = {
				# 	NOT = { religion = religion:jainism_religion }
				# }
				# set_county_faith = scope:indian_faith
				save_scope_as = county
				promote_faith_minority_effect = { FAITH = scope:indian_faith }
			}
			# DO NOT REMOVE, THIS IS FOR COMPATIBILITY WITH RICE!!!
			RICE_sri_lanka_struggle_land_grant_buddhist_effect = yes
			RICE_TFE_struggle_land_grant_jain_effect = yes
		}

		else_if = {
			limit = {
				var:RICE_india_land_grant_type = flag:nasrani
			}
			religion:christianity_religion = {
				save_scope_as = religion
			}
			add_character_modifier = {
				modifier = RICE_india_land_grant_christian_character_modifier
				years = 10
			}
			if = {
				limit = {					
					any_county_in_region = {
						region = world_india
						religion = religion:christianity_religion
					}
				}
				random_county_in_region = {
					region = world_india
					limit = {
						religion = religion:christianity_religion
					}
					save_scope_as = indian_county
				}
				scope:indian_county.faith = {
					save_scope_as = indian_faith
				}
			}
			else = {
				faith:indian_catholic = {
					save_scope_as = indian_faith
				}
			}
			if = {
				limit = {
					religion = religion:christianity_religion
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_same_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_strong_same_modifier
						years = 10
					}				
				}
			}
			else = {
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_different_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_strong_different_modifier
						years = 10
					}				
				}
			}
			if = {
				limit = {
					religion = religion:christianity_religion
				}
				add_prestige = RICE_india_grant_prestige_same_religion_value
				add_piety = RICE_india_grant_piety_same_religion_value
				stress_impact = {
					zealous = minor_stress_impact_loss
				}
			}
			else = {
				add_prestige = RICE_india_grant_prestige_different_religion_value
				add_piety = RICE_india_grant_piety_different_religion_value
				stress_impact = {
					zealous = minor_stress_impact_gain
				}
			}
			every_in_list = {
				list = RICE_land_grant_counties_conversion
				# limit = {
				# 	NOT = { religion = religion:jainism_religion }
				# }
				# set_county_faith = scope:indian_faith
				save_scope_as = county
				promote_faith_minority_effect = { FAITH = scope:indian_faith }
			}
			# DO NOT REMOVE, THIS IS FOR COMPATIBILITY WITH RICE!!!
			RICE_sri_lanka_struggle_land_grant_non_buddhist_effect = yes
		}

		else_if = {
			limit = {
				var:RICE_india_land_grant_type = flag:kochinim
			}
			religion:judaism_religion = {
				save_scope_as = religion
			}
			add_character_modifier = {
				modifier = RICE_india_land_grant_christian_character_modifier
				years = 10
			}
			if = {
				limit = {					
					any_county_in_region = {
						region = world_india
						religion = religion:judaism_religion
					}
				}
				random_county_in_region = {
					region = world_india
					limit = {
						religion = religion:judaism_religion
					}
					save_scope_as = indian_county
				}
				scope:indian_county.faith = {
					save_scope_as = indian_faith
				}
			}
			else = {
				faith:malabarism = {
					save_scope_as = indian_faith
				}
			}
			if = {
				limit = {
					religion = religion:judaism_religion
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_same_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_strong_same_modifier
						years = 10
					}				
				}
			}
			else = {
				every_held_title = {
					custom = RICE_all_held_counties_india_no_church
					limit = {
						tier = tier_county
						NOT = {
							any_county_province = {
								has_holding_type = church_holding
							}
						}
						any_county_province = {
							geographical_region = world_india
						}
					}
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_different_modifier
						years = 10
					}				
				}
				every_held_title = {
					custom = RICE_all_held_counties_india_church
					limit = {
						tier = tier_county
						any_county_province = {
							has_holding_type = church_holding
						}
						any_county_province = {
							geographical_region = world_india
						}
					}	
					add_county_modifier = {
						modifier = RICE_india_land_grant_christian_county_strong_different_modifier
						years = 10
					}				
				}
			}
			if = {
				limit = {
					religion = religion:judaism_religion
				}
				add_prestige = RICE_india_grant_prestige_same_religion_value
				add_piety = RICE_india_grant_piety_same_religion_value
				stress_impact = {
					zealous = minor_stress_impact_loss
				}
			}
			else = {
				add_prestige = RICE_india_grant_prestige_different_religion_value
				add_piety = RICE_india_grant_piety_different_religion_value
				stress_impact = {
					zealous = minor_stress_impact_gain
				}
			}
			every_in_list = {
				list = RICE_land_grant_counties_conversion
				# limit = {
				# 	NOT = { religion = religion:jainism_religion }
				# }
				# set_county_faith = scope:indian_faith
				save_scope_as = county
				promote_faith_minority_effect = { FAITH = scope:indian_faith }
			}
			# DO NOT REMOVE, THIS IS FOR COMPATIBILITY WITH RICE!!!
			RICE_sri_lanka_struggle_land_grant_non_buddhist_effect = yes
		}



		stress_impact = {
			cynical = minor_stress_impact_gain
			greedy = minor_stress_impact_gain
		}

	}

	option = { # OK
		name = sri_lanka.0010.a
	}

	after = {	
		if = {
			limit = { has_variable = RICE_india_land_grant_type }
			remove_variable = RICE_india_land_grant_type
		}
	}

}