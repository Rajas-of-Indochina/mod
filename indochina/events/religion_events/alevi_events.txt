namespace = alevi

alevi.0002 = {
	hidden = yes

	immediate = {
		if = {
			limit = {
				title:c_kyzistra = {
					OR = {
						culture = { 
							has_cultural_pillar = language_turkic 
						}
						culture = { has_cultural_pillar = heritage_iranian }
					}
				}
			}
			title:c_kyzistra = { save_scope_as = province_alevi }
		}
		else_if = {
			limit = {
				title:c_cappadocia = {
					OR = {
						culture = { 
							has_cultural_pillar = language_turkic 
						}
						culture = { has_cultural_pillar = heritage_iranian }				
					}
				}
			}
			title:c_cappadocia = { save_scope_as = province_alevi }
		}
		else_if = {
			limit = {
				title:c_kaisereia = {
					OR = {
						culture = { 
							has_cultural_pillar = language_turkic 
						}
						culture = { has_cultural_pillar = heritage_iranian }				
					}
				}
			}
			title:c_kaisereia = { save_scope_as = province_alevi }
		}
		else_if = {
			limit = {
				title:c_charsianon = {
					OR = {
						culture = { has_cultural_pillar = heritage_iranian }
						culture = { 
							has_cultural_pillar = language_turkic 
						}	
					}
				}
			}
			title:c_charsianon = { save_scope_as = province_alevi }
		}
		else = {
			title:c_nishapur = { save_scope_as = province_alevi }
		}
		create_character = {
			template = ROA_alevi_religious_leader_character
			random_traits = no
			save_scope_as = new_alevi
		}
		character:33922= {
			save_scope_as = prophet_muhammad_roa
		} 
		character:ahmad_yasawi= {
			save_scope_as = ahmad_yasawi_roa
		} 
		scope:new_alevi = {
			get_title = title:d_alevi
		give_nickname = ROA_nick_haji_bektash_veli
	add_trait_xp = {
		trait = lifestyle_mystic
		value = 100
	}		
		}
		scope:province_alevi = {
			set_county_faith = faith:alevi
			every_neighboring_county = {
				limit = {					
					NOT = { faith = faith:alevi }
					OR = {
						culture = culture:oghuz
						culture = culture:turkmen
						culture = {
							any_parent_culture_or_above = {
								culture = culture:oghuz
							}
						}
						culture = {
							any_parent_culture_or_above = {
								culture = culture:turkmen
							}
						}
					}
				}
				random = {
					chance = 30
					set_county_faith = faith:alevi
					holder = {
						every_courtier_or_guest = {
							limit = {
								is_lowborn = yes
							}
							random = {
								chance = 20
								set_character_faith = faith:alevi
							}
						}
					}
					random_neighboring_county = {
						limit = {
							culture = { 
								has_cultural_pillar = language_turkic 
							}
						}
						set_county_faith = faith:alevi
						holder = {
							every_courtier_or_guest = {
								limit = {
									is_lowborn = yes
								}
								random = {
									chance = 20
									set_character_faith = faith:alevi
								}
							}
						}
					}
				}
			}

		}
				random_county_in_region = {
					region = world_central_asia 
				
					if = {
						limit = {
							culture = { 
								has_cultural_pillar = language_turkic 
							}
							religion = religion:islam_religion				
						}
					set_county_faith = faith:alevi
					}
					else_if = {
						random_county_in_region = {
							region = world_khorasan
						
							if = {
								limit = {
									culture = { 
										has_cultural_pillar = language_turkic 
									}
									religion = religion:islam_religion				
								}
							set_county_faith = faith:alevi
							}
						}						
					}
				}
		every_ruler = {
						limit = {
							OR = {
								any_held_title = {
									tier = tier_county
									any_county_province = {
										OR = {
											geographical_region = world_middle_east
											geographical_region = world_central_asia
											geographical_region = world_persian_empire
											geographical_region = world_asia_minor
										}
									}
								}								
								AND = {
						religion = religion:islam_religion
							culture = { 
								has_cultural_pillar = language_turkic 
							}
						}
						}
						}
		trigger_event = alevi.0003
		}
	}

}

alevi.0003 = {
	type = character_event
	title = alevi.0003.t
	desc = alevi.0003.desc
	theme = learning

	right_portrait = {
		character = scope:new_alevi
		animation = chaplain 
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
	}
	
	option = { # Ok
		name = alevi.0003.a
		ai_chance = {
			base = 100
		}
	}
	
	option = { # Ok
		name = alevi.0003.b
		trigger = {
			OR = {
				is_ai = no	
			}
		}
		set_character_faith_with_conversion = faith:alevi
	}

}


